"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5061],{565061:function(e,t,n){n.r(t),n.d(t,{COMPLETE_ASSIGNMENTS:function(){return C},COMPLETE_INSTRUCTIVE:function(){return D},DISPLAY_NEW_BONUS:function(){return F},EXTEND_BATCH:function(){return O},FLAG_ASSIGNMENT:function(){return L},NEXT_ASSIGNMENT:function(){return b},REPORT_ASSIGNMENT:function(){return N},SET_BONUSES:function(){return M},SET_CURRENT_USER:function(){return I},SHOW_CORRUPTION_FEEDBACK:function(){return A},SHOW_POST_COMPLETION_FEEDBACK:function(){return w},SKIP_ASSIGNMENT:function(){return P},TRAINING_ACTIONS:function(){return ae},UPDATE_CLAIMS:function(){return U},UPDATE_PROJECT_BENCHMARK_METRICS:function(){return G},acceptProjectPricing:function(){return he},beginCourse:function(){return pe},certificationTimeRemainingSecsSync:function(){return me},checkAssignmentClaim:function(){return ee},completeAttempt:function(){return ne},completeReviewAssignment:function(){return re},completeReviewAssignments:function(){return se},completeSupplementalCourse:function(){return ie},continueCourse:function(){return fe},displayNewBonus:function(){return ye},fetchApi:function(){return j},fetchBonuses:function(){return Se},fetchCorp:function(){return H},fetchCourse:function(){return de},fetchCurrentUser:function(){return W},fetchNextAssignments:function(){return K},flagTask:function(){return z},handleErrorsAndJsonify:function(){return x},nextTask:function(){return J},refreshAssignmentClaims:function(){return te},rejectProjectPricing:function(){return Te},reportTask:function(){return V},skipBatch:function(){return Z},skipCourse:function(){return le},skipTask:function(){return Y},updateBenchmarkStats:function(){return q}});var i=n(298784),r=n.n(i),o=n(252708),s=n.n(o),a=n(468891),c=n(959807),u=n.n(c),d=n(38714),p=n(203441),l=n(445160),f=n(780201),m=n(415601),S=n(430775),y=n(141170),h=n(416233),T=n(244602),g=n(572084);var E,_=n(746332);!function(e){e.Classic="classic",e.LidarLite="lidarlite"}(E||(E={}));var k=n(203577);function v(e,t,n,i,r,o,s){try{var a=e[o](s),c=a.value}catch(u){return void n(u)}a.done?t(c):Promise.resolve(c).then(i,r)}function R(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var o=e.apply(t,n);function s(e){v(o,i,r,s,a,"next",e)}function a(e){v(o,i,r,s,a,"throw",e)}s(void 0)}))}}const I="SET_CURRENT_USER",O="EXTEND_BATCH",C="COMPLETE_ASSIGNMENTS",A="SHOW_CORRUPTION_FEEDBACK",w="SHOW_POST_COMPLETION_FEEDBACK",P="SKIP_ASSIGNMENT",N="REPORT_ASSIGNMENT",L="FLAG_ASSIGNMENT",b="NEXT_ASSIGNMENT",U="UPDATE_CLAIMS",G="UPDATE_PROJECT_BENCHMARK_METRICS",D="COMPLETE_INSTRUCTIVE",M="SET_BONUSES",F="DISPLAY_NEW_BONUS";function x(e){return $.apply(this,arguments)}function $(){return($=R((function*(e){if(!e.ok)throw new p.Z(e.statusText,yield(0,f.u)(e));return e.json()}))).apply(this,arguments)}function B(e,t,n={}){let i=e.slice();return n.returnRawResponse=!n.parseAndHandle,delete n.parseAndHandle,n.body&&(n.body=JSON.stringify(n.body),n.headers||(n.headers={"Content-Type":"application/json"})),n.query&&(i=`${i}?${a.stringify(n.query)}`),delete n.query,(0,d.ZP)(null,`${t}${i}`,n)}function H(e,t={}){return B(e,"corp-api",t)}function j(e,t={}){return B(e,"internal",t)}function W(e){return function(){var t=R((function*(t){e=e||(yield j("/logged_in_user").then(x)),t({type:I,user:e})}));return function(e){return t.apply(this,arguments)}}()}function q(){return function(){var e=R((function*(e,t){const n=r().get(t(),"batch.assignments",[]),i=r().uniq(n.map((e=>r().get(e.project,"_id",e.project))).filter((e=>!!e))),o="?projects="+i.join("&projects="),s=i.length>0?yield j(`/scaler/work/project-benchmark-stats${o}`).then(x):{};e({type:G,perProjectBenchmarkMetrics:s})}));return function(t,n){return e.apply(this,arguments)}}()}function K(e,t=!1,n){(0,_.isMobileUserAgent)(window.navigator.userAgent)&&(e.mobileAgent=1);const i=r().omit(e,"review_mode","limit");var o;i.kind="0"===(o=e.review_mode)?"task":"1"===o?"review":void 0;const a=(c=i,r().map(c,((e,t)=>e?`&${t}=${e}`:"")).join(""));var c;return function(){var e=R((function*(e,i){const o=i();if(r().get(o,"batch.assignments.length",0)>2)return void q()(e,i);const c=null!==n&&void 0!==n?n:1;try{const t=r().uniqBy(yield j(`/v2/tasks/new_queue?limit=${c}${a}`).then(x),(e=>null===e||void 0===e?void 0:e._id)),n=t.filter((e=>e.assignmentType===g.vxv.Course))[0];n&&e({type:ae.SET_COURSE,course:n}),e({type:ae.SET_LOADING,isLoading:!1}),e({type:O,assignments:(0,l.WG)(t)}),e(q())}catch(u){if(u.response&&403===u.response.status)"Tasker account is not verified"===u.response.error?window.location="/account":window.location="/forbidden";else if(u.response&&429===u.response.status)u.logToSentry&&u.logToSentry("too many assignment fetch"),s().error("You have refreshed this page too quickly, or opened many windows at the same time. Please slow down, and don't refresh across multiple windows. You can retry after one minute.",{timeout:"none"});else if(u.logToSentry&&u.logToSentry("fetching next assignments"),s().error(u.message,{timeout:3e3}),t)throw u}}));return function(t,n){return e.apply(this,arguments)}}()}function Z(e,t,n,i){return function(){var r=R((function*(r,o){const s=yield j("/batch/skip",{method:"POST",body:{batchId:t,info:{skipReason:n,skipExplanation:i}}}).then(x);s.tooManySkips?alert("You have already reached the limit on skips for the day."):(K(e)(r,o),r({type:P,response:s}))}));return function(e,t){return r.apply(this,arguments)}}()}function Y(e,t,n,i){const r=(0,T.t)();S.Z.warn("Skipped Task",{assignmentId:t._id,attemptId:t.attemptId,skipReason:n,skipExplanation:i,pageLoadId:r});const o={skipReason:n,skipExplanation:i};let s,a,c;return(0,y.F)(t)?(a=[t.attemptId],c="/attempts/unassign"):(s=[t._id],c="/tasks/unassign"),function(){var t=R((function*(t){const n=yield j(c,{method:"POST",body:{taskIds:s,attemptIds:a,isSkippedTask:!0,isSkipUserInitiated:!0,info:o}}).then(x);n.tooManySkips?alert("You have already reached the limit on skips for the day."):(t(K(e)),t({type:P,response:n}))}));return function(e){return t.apply(this,arguments)}}()}function V(e,t,n,i){const r=(0,T.t)();return S.Z.warn("Reported Task",{assignmentId:t._id,attemptId:t.attemptId,reportReason:n,reportExplanation:i,pageLoadId:r}),function(){var o=R((function*(o,s){const a=yield j("/tasks/report",{method:"POST",body:{taskId:t._id,reportReason:n,reportExplanation:i}}).then(x);a.tooManySkips?(alert("You have already reached the limit on reports for the day."),S.Z.warn("Task Report Limit Reached",{assignmentId:t._id,attemptId:t.attemptId,reportReason:n,reportExplanation:i,pageLoadId:r})):(K(e)(o,s),o({type:N,response:a}))}));return function(e,t){return o.apply(this,arguments)}}()}function z(e,t,n,i){const r=(0,T.t)();return S.Z.warn("Flagged Task",{assignmentId:t._id,attemptId:t.attemptId,flagCategory:n,reason:i,pageLoadId:r}),function(){var r=R((function*(r,o){const s=yield j("/tasks/flag",{method:"POST",body:{taskId:t._id,flagCategory:n,reason:i}}).then(x);K(e)(r,o),r({type:L,response:s})}));return function(e,t){return r.apply(this,arguments)}}()}function J(e,t=!1,n){return function(){var i=R((function*(i,o){try{if(t)window.location.href="/qa/audit";else{const t=o();r().get(t,"batch.forceFixAssignment")||(i({type:b}),yield K(e,!0,n)(i,o))}}catch(s){window.location.reload()}}));return function(e,t){return i.apply(this,arguments)}}()}const X=["task_id","timeSpentSecs","timeSpentLoadingSecs","oldTimeSpentSecs"],Q={annotation:[...X,"annotations"],audiotranscription:X,fixannotation:[...X,"annotation"],polygonannotation:[...X,"annotations"],lineannotation:[...X,"annotations"],laneannotation:[...X,"annotations"],pointannotation:[...X,"annotations"]};function ee({stage:e,task:t,attempt:n,elapsedTime:i,force:o}){return function(){var s=R((function*(s){const{forceClaim:c}=a.parse(window.location.search),u={stage:e,task:t,attempt:n,elapsedTime:i,usingForceClaimLink:"1"===c},{tasks:d,attempts:p,stages:l,currentPageHasEditLock:f,otherUserHasLock:m,canOverride:S,hasForcePermission:y}=yield j("/tasks/check_claim",{method:"POST",body:u}).then(x);if(y&&o)return;const h={};r().each(r().concat(d,p,l),(e=>{h[e.id]={claimed:e.claimed,claimedUntil:new Date(e.claimedUntil),maxClaim:new Date(e.maxClaim||Date.now()+1e3),idleMinutes:parseInt(e.idleMinutes),checkedAt:new Date(e.checkedAt),checkedAtClientTime:new Date,hasWarning:e.hasWarning,warningParams:e.warningParams,corruptionFeedback:e.corruptionFeedback}})),s({type:U,claims:h,currentPageHasEditLock:f,otherUserHasLock:m,canOverride:S})}));return function(e){return s.apply(this,arguments)}}()}function te({stages:e,tasks:t,attempts:n,elapsedTime:i,force:o}){return function(){var s=R((function*(s){const a={reclaim:{tasks:t,attempts:n,stages:e},elapsedTime:i},c=yield j("/tasks/check_claim",{method:"POST",body:a}).then(x);if(c.hasForcePermission&&o)return;const u={};r().each(r().concat(c.tasks,c.attempts,c.stages),(e=>{u[e.id]={claimed:e.claimed,claimedUntil:new Date(e.claimedUntil),maxClaim:new Date(e.maxClaim||Date.now()+1e3),idleMinutes:parseInt(e.idleMinutes),checkedAt:new Date(e.checkedAt),checkedAtClientTime:new Date,hasWarning:e.hasWarning,warningParams:e.warningParams,corruptionFeedback:e.corruptionFeedback}})),s({type:U,claims:u})}));return function(e){return s.apply(this,arguments)}}()}function ne(e,t,n={}){return n.timeSpentLoadingSecs||(n.timeSpentLoadingSecs=-1),(e=>{const t=Q[e]||[];return e=>{r().each(t,(t=>{if(!r().has(e,t))throw Error(`${t} is required in \`completeAttempt\``)}))}})(t)(n),n.toolSource=E.Classic,function(){var i=R((function*(i,r){const o=t===g.UAI.Categorization,s={body:n,method:"POST"};let a;if(o){const n=function(){var n=R((function*(){a=yield j(`/complete/${t}`,s).then(x),K(e)(i,r)}));return function(){return n.apply(this,arguments)}}();yield n()}else if(a=yield j(`/complete/${t}`,s).then(x),!a)return;return a.trainingAttempt&&i({type:D,instructiveResponse:a.trainingAttempt}),h.c.track("Completed Task",{time_elapsed_in_seconds:n.timeSpentSecs,task_id:n.task_id,num_annotations:n.annotations&&n.annotations.length,type:t},{traits:{pageLoadId:(0,T.t)()}}),a}));return function(e,t){return i.apply(this,arguments)}}()}function ie(e){return function(){var t=R((function*(t,n){t({type:b}),t({type:ae.SET_COURSE_PROGRESS,courseProgress:{currentSection:-1}});const i=n().batch.assignments.filter((e=>e.assignmentType===g.vxv.Course))[0];t({type:ae.SET_COURSE,course:i}),i||K(e)(t,n)}));return function(e,n){return t.apply(this,arguments)}}()}function re(e,t,{isCorrect:n,timeSpentSecs:i,populateHypothesis:o,oldTimeSpentSecs:s,timeSpentLoadingSecs:a,trueReviewOutcome:c,reviewChanges:u,benchmark:d,comments:p,fullstorySession:l,extra:f,auditResult:y,categorizationResult:g,taskFeedback:_,sendType:v,linterMetrics:I,documentRotation:O,documentRotationPerPage:C},P=(()=>{})){return function(){var N=R((function*(R){const N={attemptId:t.attemptId,reviewTimeSecs:i,reviewOldTimeSecs:s,reviewTimeLoadingSecs:a,attemptVersion:t.attemptVersion,trueReviewOutcome:null!==c&&void 0!==c?c:void 0!==v?(0,k.I8)(v):void 0,reviewResult:n?"correct":"incorrect",populateHypothesis:o,reviewChanges:u,benchmark:d,comments:p,fullstorySession:l,extra:f,auditResult:y,categorizationResult:g,taskFeedback:_,toolSource:E.Classic,sendType:void 0!==v?k.a5[v]:void 0,linterMetrics:I,documentRotation:O,documentRotationPerPage:C},L=yield j(`/complete/review/${t.type}`,{body:N,method:"POST"}).then(x);if(!L)return;yield P(),S.Z.log(`Succesfully completed review: ${t.attemptId} with taskFeedback ${_}`);const b=r().get(L,"corruptionFeedback.corruptionAccuracy"),U=null===L||void 0===L?void 0:L.postCompletionFeedback;if(0===b||b)R({type:A,corruptionFeedback:L.corruptionFeedback,corruptionFeedbackAttempt:L.attempt,confidenceAction:L.confidenceAction,reviewTimeSecs:N.reviewTimeSecs});else{if(L.trainingAttempt&&R({type:D,instructiveResponse:L.trainingAttempt}),U&&R({type:w,postCompletionFeedback:U}),!1===r().get(L.trainingAttempt,"submitted"))return L;e=r().omit(e,"lidarId"),L.confidenceAction?(0,m.ZP)(null,`/corrected_reviews?confidenceAction=${L.confidenceAction}`):h.c.track("Completed Task",{time_elapsed_in_seconds:N.reviewTimeSecs,type:t.type},{traits:{pageLoadId:(0,T.t)()}})}return L}));return function(e){return N.apply(this,arguments)}}()}const oe=function(){var e=R((function*(e,{isCorrect:t,timeSpentSecs:n,populateHypothesis:i,oldTimeSpentSecs:r,timeSpentLoadingSecs:o,reviewChanges:s,benchmark:a,comments:c,fullstorySession:u,extra:d,auditResult:p,taskFeedback:l}){const f={attemptId:e.attemptId,reviewTimeSecs:n,reviewOldTimeSecs:r,reviewTimeLoadingSecs:o,attemptVersion:e.attemptVersion,reviewResult:t?"correct":"incorrect",populateHypothesis:i,reviewChanges:s,benchmark:a,comments:c,fullstorySession:u,extra:d,auditResult:p,taskFeedback:l};yield j(`/complete/review/${e.type}`,{body:f,method:"POST"}).then(x),h.c.track("Completed Task",{time_elapsed_in_seconds:f.reviewTimeSecs,type:e.type},{traits:{pageLoadId:(0,T.t)()}})}));return function(t,n){return e.apply(this,arguments)}}();function se(e,t,n){return function(){var i=R((function*(i){yield u().map(t,function(){var e=R((function*(e,t){try{yield oe(e,n[t])}catch(i){}}));return function(t,n){return e.apply(this,arguments)}}(),{concurrency:3}),i({type:C,assignments:t}),i(K(e=r().omit(e,"lidarId")))}));return function(e){return i.apply(this,arguments)}}()}const ae={SET_LOADING:"TRAINING_ACTIONS/SET_LOADING",SET_COURSE:"TRAINING_ACTIONS/SET_COURSE",SET_COURSE_PROGRESS:"TRAINING_ACTIONS/SET_COURSE_PROGRESS",SET_COURSE_ERROR:"TRAINING_ACTIONS/SET_COURSE_ERROR"};function ce(e,t){var n;const i=null===t||void 0===t||null===(n=t.certificationInfo)||void 0===n?void 0:n.randomizedSections;i&&i.length>0&&(e.sections=i)}function ue(e,t){const n=null===t||void 0===t?void 0:t.overridingSections;n&&n.length>0&&(e.sections=n)}function de(e,t){return function(){var n=R((function*(n){n({type:ae.SET_LOADING,isLoading:!0});let i=!1;let r=`/courses/${encodeURIComponent(e)}`;t&&(r+=`?tag=${t}`);const o=yield j(r,{}).then(x).catch((e=>(i=!0,e.response)));if(i)return n({type:ae.SET_LOADING,isLoading:!1}),void n({type:ae.SET_COURSE_ERROR,courseError:o.error||"There was an error loading the course"});const{course:s,courseProgress:a}=o;ce(s,a),ue(s,a),n({type:ae.SET_COURSE,course:s}),n({type:ae.SET_COURSE_PROGRESS,courseProgress:a}),n({type:ae.SET_LOADING,isLoading:!1})}));return function(e){return n.apply(this,arguments)}}()}function pe(e,t){return function(){var n=R((function*(n,i){n({type:ae.SET_LOADING,isLoading:!0});const r={method:"POST",body:{permissionId:t}},o=yield j(`/courses/${e}/begin`,r).then(x),s=i().training.course,{courseProgress:a}=o;ce(s,a),ue(s,a),n({type:ae.SET_COURSE,course:s}),n({type:ae.SET_COURSE_PROGRESS,courseProgress:a}),n({type:ae.SET_LOADING,isLoading:!1})}));return function(e,t){return n.apply(this,arguments)}}()}function le(e,t){return function(){var n=R((function*(n,i){n({type:ae.SET_LOADING,isLoading:!0});yield j(`/courses/${t}/skip`,{method:"POST"}).then(x),n({type:ae.SET_LOADING,isLoading:!1}),n({type:b});const r=i().batch.assignments.filter((e=>e.assignmentType===g.vxv.Course))[0];n({type:ae.SET_COURSE,course:r}),r||K(e)(n,i)}));return function(e,t){return n.apply(this,arguments)}}()}function fe(e,t){return function(){var n=R((function*(n){n({type:ae.SET_LOADING,isLoading:!0});const i={method:"POST",body:t},r=yield j(`/courses/${e}/continue`,i).then(x),{courseProgress:o}=r;ue(o.course,o),n({type:ae.SET_COURSE_PROGRESS,courseProgress:r.courseProgress}),n({type:ae.SET_LOADING,isLoading:!1})}));return function(e){return n.apply(this,arguments)}}()}function me(e,t){return function(){var n=R((function*(n){const i={method:"POST",body:{certificationTimeRemainingSecs:t}},r=yield j(`/courses/${e}/certificationTimeRemainingSecsSync`,i).then(x);n({type:ae.SET_COURSE_PROGRESS,courseProgress:r.courseProgress})}));return function(e){return n.apply(this,arguments)}}()}function Se(e=!1){return function(){var t=R((function*(t){const n=yield j("/scaler/work/bonuses/current_and_completed",{method:"GET"}).then(x);t({type:M,bonuses:n,first:e})}));return function(e){return t.apply(this,arguments)}}()}function ye(e){return function(){var t=R((function*(t){t({type:F,bonus:e})}));return function(e){return t.apply(this,arguments)}}()}function he(e,t){return R((function*(){yield j("/rateconsent/accept",{method:"POST",body:{projectId:e,rate:t}}).then(x),window.location.reload(),yield u().delay(5e3)}))}function Te(e,t){return R((function*(){yield j("/rateconsent/reject",{method:"POST",body:{projectId:e,rate:t}}).then(x),window.location.reload(),yield u().delay(5e3)}))}}}]);