"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6882],{76882:function(e,t,n){n.d(t,{Z:function(){return pt}});var i=n(824246),a=n(827378),o=n(68649),s=n(335331),r=n(679892),l=n.n(r),c=n(682097),d=n(585912),p=n(505940),u=n(275534),h=n(318681),m=n(390547),f=n(792739),x=n(400070),g=n(298784),y=n.n(g),b=n(542280);function v(e,t,n,i,a,o,s){try{var r=e[o](s),l=r.value}catch(c){return void n(c)}r.done?t(l):Promise.resolve(l).then(i,a)}const j=(0,o.ZL)({sectionButton:{outline:"none",background:"#F8F8F8",border:"none",padding:"4px 6px",marginLeft:6,borderRadius:4,fontSize:14,fontWeight:500,color:"#DD45D3",cursor:"pointer",transition:"background 120ms ease-out","&:hover":{background:b.ZP.colors.periwinkle25}},questionMenu:{position:"absolute",top:32,left:6,background:"white",padding:4,borderRadius:8,minWidth:200,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.2)"},menuItem:{display:"flex",alignItems:"center",fontSize:14,fontWeight:400,padding:8,borderRadius:4,cursor:"pointer","&:hover":{background:b.ZP.colors.periwinkle25}}}),w=({lastSelection:e,shouldShowLabeledExamples:t})=>{const n=j(),{0:o,1:s}=(0,a.useState)(!1),r=(0,u.ui)(),l=t=>{let n;"iframe"===t?n={type:"iframe",url:"",children:[{text:""}]}:"exampleLabel"===t&&(n={type:"label-section",labelName:y().startCase(y().toLower("Label Name...")),examples:[],children:[{text:""}]}),n&&(d.YR.select(r,e),d.YR.insertNodes(r,n),d.YR.insertNodes(r,{type:"paragraph",children:[{text:" "}]})),s(!o)},p=function(){var t,n=(t=function*(t){if(t&&t.length>0){const{assetId:n}=yield c.Z.selfserve.uploadInstructionImage({file:t.item(0)});if(n){const t={type:"image",assetId:n,children:[{text:""}]};d.YR.select(r,e),d.YR.insertNodes(r,t),d.YR.insertNodes(r,{type:"paragraph",children:[{text:" "}]})}}s(!o)},function(){var e=this,n=arguments;return new Promise((function(i,a){var o=t.apply(e,n);function s(e){v(o,i,a,s,r,"next",e)}function r(e){v(o,i,a,s,r,"throw",e)}s(void 0)}))});return function(e){return n.apply(this,arguments)}}();return(0,i.jsxs)("div",{style:{position:"relative",margin:"16px 0"},children:[(0,i.jsx)("button",{style:{color:b.ZP.colors.periwinkle100},className:n.sectionButton,onClick:e=>{e.preventDefault(),s(!o)},children:"Insert"}),o&&(0,i.jsxs)("div",{className:n.questionMenu,children:[(0,i.jsxs)("div",{className:n.menuItem,onClick:()=>l("iframe"),children:[(0,i.jsx)(f.G,{icon:"anchor",color:"#555",style:{width:16,height:16,marginRight:12}}),"Iframe (embed URL)"]}),(0,i.jsx)("label",{htmlFor:"file-upload",children:(0,i.jsxs)("div",{className:n.menuItem,children:[(0,i.jsx)(f.G,{icon:"image",color:"#555",style:{width:16,height:16,marginRight:12}}),"Image or PDF"]})}),(0,i.jsx)("input",{style:{display:"none",opacity:0},id:"file-upload",type:"file",accept:"image/*,application/pdf",onChange:e=>p(e.target.files)}),t&&(0,i.jsxs)("div",{className:n.menuItem,onClick:()=>l("exampleLabel"),children:[(0,i.jsx)(f.G,{icon:"tag",color:"#555",style:{width:16,height:16,marginRight:12}}),"Labeled Examples"]})]})]})};var S=n(625008),T=n(995632),I=n(161320),O=n.n(I);const N=(0,o.ZL)({container:{display:"flex",flexDirection:"column",alignItems:"center"},dialog:{width:"500px",overflow:"hidden",margin:"2% auto 20px"},dialogRoot:{zIndex:"110 !important"},createButton:{paddingTop:"15px"}});var k=({modalOpen:e,setModalOpen:t,changeDescription:n,setChangeDescription:a})=>{const o=N(),s=e=>{"keydown"===(null===e||void 0===e?void 0:e.type)&&27===(null===e||void 0===e?void 0:e.keyCode)||t(!1)};return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(S.Vq,{classes:{root:o.dialogRoot,paper:o.dialog},open:e,onClose:s,children:[(0,i.jsx)(S.$N,{children:(0,i.jsx)("div",{style:{textAlign:"center",fontWeight:500,fontSize:"16px",lineHeight:"20px"},children:"Provide a brief summary of changes for labelers (optional)"})}),(0,i.jsx)(S.cZ,{children:(0,i.jsxs)("div",{className:o.container,children:[(0,i.jsx)(S.oi,{size:"large",fullWidth:!0,placeholder:"Brief summary of changes",label:"Description",value:n,onChange:e=>{a(e.target.value)}}),(0,i.jsx)("div",{className:o.createButton,children:(0,i.jsx)(S.zx,{type:"primary",onClick:s,children:"Confirm"})})]})})]})})};function E(e,t,n,i,a,o,s){try{var r=e[o](s),l=r.value}catch(c){return void n(c)}r.done?t(l):Promise.resolve(l).then(i,a)}const C=(0,b.ZL)((e=>({toolbar:{background:"#F8F8F8",zIndex:1,display:"flex",flexDirection:"row",alignItems:"center",padding:e.spacing(0,2),minWidth:600},menuButton:{marginRight:e.spacing(2)},activeIcon:{color:`${e.colors.primary1} !important`},icon:{width:18,height:18},text:{fontSize:"16px",fontWeight:"normal"},actions:{display:"flex",marginLeft:"auto",justifyContent:"end",alignItems:"center"},updateActions:{width:"300px",display:"flex",marginRight:e.spacing(2),marginLeft:e.spacing(2)}})));var A=({toggleMark:e,toggleBlock:t,isBlockActive:n,isMarkActive:o,lastSelection:s,shouldShowLabeledExamples:r=!0,handleSave:l,updatedAt:c,isDirty:d=!0,isOnboardingComplete:p=!0})=>{const g=C(),y=(0,u.ui)(),[b,v]=(0,T.Z)(!1),[j,I]=(0,T.Z)(!1),[N,A]=(0,T.Z)(!1),{0:P,1:_}=(0,a.useState)(""),[R,D]=(0,T.Z)(!1),L=(0,a.useCallback)((()=>{j||A(!0),I()}),[j,I,A]),Z=(n,i,a="mark")=>{n.preventDefault(),"mark"===a?e(y,i):"block"===a&&t(y,i)};return(0,i.jsxs)(h.Z,{className:g.toolbar,children:[[1,2,3,4].map(((e,t)=>(0,i.jsx)(x.ZP,{placement:"bottom",title:`Header Level ${t+1}`,children:(0,i.jsx)(m.Z,{edge:"start",color:"inherit",onMouseDown:e=>Z(e,`heading-${t+1}`,"block"),children:(0,i.jsx)("span",{className:`${g.text} ${n(y,`heading-${t+1}`)?g.activeIcon:""} `,children:`H${t+1}`})})},t))),(0,i.jsx)(x.ZP,{placement:"bottom",title:"Bold",children:(0,i.jsx)(m.Z,{edge:"start",color:"inherit",onMouseDown:e=>Z(e,"bold"),children:(0,i.jsx)(f.G,{icon:"bold",className:`${g.icon} ${o(y,"bold")?g.activeIcon:""}`})})}),(0,i.jsx)(x.ZP,{placement:"bottom",title:"Italic",children:(0,i.jsx)(m.Z,{edge:"start",color:"inherit",onMouseDown:e=>Z(e,"italic"),children:(0,i.jsx)(f.G,{icon:"italic",className:`${g.icon} ${o(y,"italic")?g.activeIcon:""} `})})}),(0,i.jsx)(x.ZP,{placement:"bottom",title:"Underline",children:(0,i.jsx)(m.Z,{edge:"start",color:"inherit",onMouseDown:e=>Z(e,"underline"),children:(0,i.jsx)(f.G,{icon:"underline",className:`${g.icon} ${o(y,"underline")?g.activeIcon:""} `})})}),(0,i.jsx)(x.ZP,{placement:"bottom",title:"Bulleted List",children:(0,i.jsx)(m.Z,{edge:"start",color:"inherit",onMouseDown:e=>Z(e,"bulleted-list","block"),children:(0,i.jsx)(f.G,{icon:"list",className:`${g.icon} ${n(y,"bulleted-list")?g.activeIcon:""} `})})}),(0,i.jsx)(x.ZP,{placement:"bottom",title:"Numbered List",children:(0,i.jsx)(m.Z,{edge:"start",color:"inherit",onMouseDown:e=>Z(e,"numbered-list","block"),children:(0,i.jsx)(f.G,{icon:"list-ol",className:`${g.icon} ${n(y,"numbered-list")?g.activeIcon:""} `})})}),(0,i.jsx)(w,{lastSelection:s,shouldShowLabeledExamples:r}),c&&(0,i.jsxs)("div",{style:{marginLeft:8},children:["Updated: ",O()(c).format("MM/DD/YY hh:mmA")]}),(0,i.jsx)(i.Fragment,{children:l&&(0,i.jsxs)("div",{className:g.actions,children:[p&&(0,i.jsxs)("div",{className:g.updateActions,children:[N&&(0,i.jsx)(k,{modalOpen:N,setModalOpen:A,changeDescription:P,setChangeDescription:_}),(0,i.jsx)(S.XZ,{label:"update labelers",checked:j,onChange:L}),(0,i.jsx)(x.ZP,{title:"Force labelers to reread the new instructions.",placement:"top",children:(0,i.jsx)("div",{style:{paddingLeft:"4px",lineHeight:"32px",textAlign:"center"},children:(0,i.jsx)(f.G,{icon:"question-circle",color:"gray"})})}),(0,i.jsx)(S.XZ,{label:"update tasks",checked:b,onChange:v}),(0,i.jsx)(x.ZP,{title:"Update existing pending tasks with new instructions.",placement:"top",children:(0,i.jsx)("div",{style:{paddingLeft:"4px",lineHeight:"32px",textAlign:"center"},children:(0,i.jsx)(f.G,{icon:"question-circle",color:"gray"})})})]}),(0,i.jsxs)(S.zx,{type:"primary",disabled:!l||!d||R,onClick:(M=function*(){l&&(D(!0),yield l(b,j,P),_(""),D(!1))},function(){var e=this,t=arguments;return new Promise((function(n,i){var a=M.apply(e,t);function o(e){E(a,n,i,o,s,"next",e)}function s(e){E(a,n,i,o,s,"throw",e)}o(void 0)}))}),children:["Save",!!R&&(0,i.jsx)(S.D8,{size:12,color:"primary",style:{marginLeft:8}})]})]})})]});var M};const P=({onClick:e})=>(0,i.jsx)(m.Z,{edge:"start",color:"inherit",onMouseDown:()=>e(),children:(0,i.jsx)(f.G,{style:{width:16,height:16,cursor:"pointer",opacity:.75},icon:"trash"})});function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const R=({attributes:e,children:t,element:n,readOnly:o,setInfoMsg:s})=>{const{url:r}=n,l=(0,u.ui)(),{0:c,1:p}=(0,a.useState)(r);return(0,i.jsxs)("div",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){_(e,t,n[t])}))}return e}({},e,{style:{border:"1px solid #E6E6E6"},children:[!o&&(0,i.jsxs)("div",{style:{display:"flex"},children:[(0,i.jsx)("div",{style:{left:"96%",position:"relative",color:b.ZP.colors.primary1},children:(0,i.jsx)(P,{onClick:()=>{d.YR.delete(l,{at:u.F3.findPath(l,n)})}})}),(0,i.jsxs)("div",{contentEditable:!1,style:{width:"90%",display:"flex"},children:[(0,i.jsx)("div",{style:{opacity:.5,fontSize:"16px",paddingRight:"8px",paddingTop:"8px"},children:"url:"}),(0,i.jsx)("div",{style:{paddingTop:"4px",width:"100%"},children:(0,i.jsx)(S.oi,{placeholder:"Enter publicly accessible url to embed in this iframe",fullWidth:!0,autoFocus:!1,value:c,onChange:e=>{e.preventDefault(),p(e.target.value);const t=u.F3.findPath(l,n);d.YR.setNodes(l,{url:e.target.value},{at:t})},onBlur:e=>{s&&(s("Please make sure your url is publicly accessible!"),setTimeout((()=>s("")),5e3))}})})]})]}),(0,i.jsx)("div",{contentEditable:!1,children:(0,i.jsx)("div",{style:{padding:"75% 0 0 0",position:"relative"},children:(0,i.jsx)("iframe",{src:r,frameBorder:"0",style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%"}})})}),t]}))};var D=n(38714);function L(e,t,n,i,a,o,s){try{var r=e[o](s),l=r.value}catch(c){return void n(c)}r.done?t(l):Promise.resolve(l).then(i,a)}function Z(e){return function(){var t=this,n=arguments;return new Promise((function(i,a){var o=e.apply(t,n);function s(e){L(o,i,a,s,r,"next",e)}function r(e){L(o,i,a,s,r,"throw",e)}s(void 0)}))}}function M(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const F=({attributes:e,children:t,element:n})=>{const{assetId:o}=n,{0:s,1:r}=(0,a.useState)(null);return(0,a.useEffect)((()=>{function e(){return(e=Z((function*(){try{const e=yield c.Z.selfserve.fetchInstructionAssetS3URL({assetId:o});e&&r(e)}catch(e){(0,D.vj)(e,{handleHttp:!0})}}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[o]),(0,i.jsxs)("div",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){M(e,t,n[t])}))}return e}({},e,{className:"jsx-1779f09ba0f2df0 "+(e&&null!=e.className&&e.className||"imageContainer"),children:[(0,i.jsx)("div",{contentEditable:!1,style:{display:"flex"},className:"jsx-1779f09ba0f2df0",children:s?(0,i.jsx)(i.Fragment,{children:"application/pdf"===s.mimeType?(0,i.jsx)("object",{data:s.signedURL+"#toolbar=0",type:"application/pdf",width:"100%",height:"800",className:"jsx-1779f09ba0f2df0"}):(0,i.jsx)("img",{src:s.signedURL,className:"jsx-1779f09ba0f2df0"})}):(0,i.jsx)("div",{className:"jsx-1779f09ba0f2df0",children:"loading..."})}),t,(0,i.jsx)(l(),{id:"1779f09ba0f2df0",children:".button.jsx-1779f09ba0f2df0{opacity:0;position:relative;right:-33%;top:-12px}.imageContainer.jsx-1779f09ba0f2df0:hover .button.jsx-1779f09ba0f2df0{opacity:1}"})]}))};var U=n(572084),B=n(687192),z=n(60042),$=n.n(z);const W=(0,o.ZL)({container:{display:"flex",flexDirection:"column",justifyContent:"center",flexFlow:"column nowrap",flexWrap:"nowrap"},exampleTypeSelector:{display:"flex",justifyContent:"center",marginBottom:"12px"},exampleType:{margin:"8px",padding:"2px 8px 2px 8px",border:"1px solid #E6E6E6",borderRadius:"8px"},exampleTypeClickable:{cursor:"pointer"}});var V=({exampleType:e,disabled:t,setExampleType:n,readOnly:a})=>{const o=W();return(0,i.jsx)("div",{className:o.container,children:(0,i.jsxs)("div",{className:o.exampleTypeSelector,children:[(!a||"good"===e)&&(0,i.jsxs)("div",{className:$()(o.exampleType,{[o.exampleTypeClickable]:!t}),onClick:()=>!t&&n("good"),style:"good"===e?{border:"1px solid green"}:{},children:[(0,i.jsx)(f.G,{icon:"check-circle",color:"green",style:{fontSize:"11px",lineHeight:"16px",marginRight:8,opacity:.5}}),"Well labeled example"]}),(!a||"bad"===e)&&(0,i.jsxs)("div",{className:$()(o.exampleType,{[o.exampleTypeClickable]:!t}),onClick:()=>!t&&n("bad"),style:"bad"===e?{border:"1px solid red"}:{},children:[(0,i.jsx)(f.G,{icon:"times-circle",color:"red",style:{fontSize:"11px",lineHeight:"16px",marginRight:8,opacity:.3}}),"Poorly labeled example"]})]})})},G=n(176832),H=n(271682),Y=n(66285),q=n(431350),Q=n(790606),X=n(456552),J=n(648019),K=n(802638),ee=n(776136);var te,ne=({isOpen:e,canSubmit:t=!0,message:n,onSubmit:a,onRequestClose:o,marginAmount:s})=>(0,i.jsxs)(K.u_,{maxWidth:600,isOpen:e,onRequestClose:o,contentLabel:"Confirmation",margin:s,children:[(0,i.jsx)(K.xB,{onRequestClose:o,children:"Confirmation"}),(0,i.jsx)(K.fe,{children:n}),(0,i.jsx)(K.mz,{children:(0,i.jsxs)("div",{className:"jsx-186b16cd0a3c6117 actions",children:[(0,i.jsx)(ee.Z,{secondary:!0,onClick:o,children:"Cancel"}),(0,i.jsx)(ee.Z,{disabled:!t,onClick:a,style:{color:"white",background:b.ZP.colors.primary1,marginLeft:12},children:"Confirm"})]})}),(0,i.jsx)(l(),{id:"186b16cd0a3c6117",children:".actions.jsx-186b16cd0a3c6117{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;-webkit-justify-content:flex-end;justify-content:flex-end}"})]});n(41952),n(941085);!function(e){e.EU_DATA="EU_DATA",e.US_DATA="US_DATA",e.SENSITIVE_CONTENT_OBSCENE="SENSITIVE_CONTENT_OBSCENE",e.SENSITIVE_CONTENT_VIOLENT="SENSITIVE_CONTENT_VIOLENT",e.SENSITIVE_CONTENT_DEFAMATORY="SENSITIVE_CONTENT_DEFAMATORY",e.SENSITIVE_CONTENT_WEAPONS="SENSITIVE_CONTENT_WEAPONS",e.SENSITIVE_CONTENT_TERROR="SENSITIVE_CONTENT_TERROR",e.SENSITIVE_CONTENT_PUBLICITY_RIGHTS="SENSITIVE_CONTENT_PUBLICITY_RIGHTS",e.HIPAA_VENDOR="HIPAA_VENDOR",e.HIPAA_ATTACHMENTS="HIPAA_ATTACHMENTS",e.HIPAA_RESPONSES="HIPAA_RESPONSES",e.PII="PII",e.PERSONAL_TRAITS="PERSONAL_TRAITS",e.FINANCIAL_INST="FINANCIAL_INST",e.OWNERSHIP="OWNERSHIP"}(te||(te={}));te.EU_DATA,te.US_DATA;const ie={[te.SENSITIVE_CONTENT_OBSCENE]:"The data is obscene, pornographic, or indecent",[te.SENSITIVE_CONTENT_VIOLENT]:"The data is violent (including suicide and self-harm), threatening, hateful, or discriminatory",[te.SENSITIVE_CONTENT_DEFAMATORY]:"The data is defamatory, harassing, misleading, or fraudulent",[te.SENSITIVE_CONTENT_WEAPONS]:"The data depicts weapons, illegal drugs, or drug paraphernalia",[te.SENSITIVE_CONTENT_TERROR]:"The data promotes or supports terror or hate groups",[te.SENSITIVE_CONTENT_PUBLICITY_RIGHTS]:"The data violates or may violate the privacy or publicity rights of any person or entity"};te.HIPAA_VENDOR,te.HIPAA_ATTACHMENTS,te.HIPAA_RESPONSES,te.PII,te.PERSONAL_TRAITS,te.FINANCIAL_INST,te.OWNERSHIP,Object.keys(ie),te.HIPAA_RESPONSES;var ae,oe,se,re,le=n(554211),ce=n(142262);!function(e){e.Creation="creation",e.DataUpload="dataupload",e.DataView="dataview",e.ProjectConfig="projectconfig",e.Taxonomy="taxonomy",e.Instruction="instruction",e.Task="task",e.Workforce="workforce",e.DataSelect="dataselect",e.ProjectSettings="projectsettings",e.Payment="payment",e.Complete="complete"}(ae||(ae={})),function(e){e.Creation="creation",e.Data="data",e.ProjectConfig="projectconfig",e.Taxonomy="taxonomy",e.Instruction="instruction",e.Task="task",e.Batch="batch",e.Summary="summary"}(oe||(oe={})),function(e){e.Incomplete="incomplete",e.Complete="complete",e.Locked="locked"}(se||(se={})),function(e){e.View="view",e.Taxonomy="editTaxonomy",e.Changes="propagateChanges",e.Instructions="editInstructions"}(re||(re={}));const de=a.createContext({isOnboardingComplete:void 0,setIsOnboardingComplete:()=>{},loading:void 0,setLoading:()=>{},project:void 0,setProject:()=>{},currentView:void 0,setCurrentView:()=>{},currentStep:void 0,setCurrentStep:()=>{},hasAssets:void 0,setHasAssets:()=>{},onboardingSteps:[],setOnboardingSteps:()=>{},firstBatchSelectedMap:void 0,setFirstBatchSelectedMap:()=>{},selectionQueryFilter:void 0,setSelectionQueryFilter:()=>{},firstBatchSelectionMethod:void 0,setFirstBatchSelectionMethod:()=>{},firstBatchNumTasks:void 0,setFirstBatchNumTasks:()=>{},numAssets:void 0,setNumAssets:()=>{},taskCount:void 0,setTaskCount:()=>{},costEstimate:void 0,setCostEstimate:()=>{},taskType:void 0,setTaskType:()=>{},projectUseCase:void 0,setProjectUseCase:()=>{},finalizeOnboarding:()=>{},nextEnabled:void 0,setNextEnabled:()=>{},batchSelected:void 0,setBatchSelected:()=>{},batchName:"first_batch",setBatchName:()=>{},isSelfLabel:!1,projectOptions:void 0,setProjectOptions:()=>{},useOldOnboarding:!1,setUseOldOnboarding:()=>{},sensitiveDataSelections:y().zipObject(Object.values(te),new Array(Object.keys(te).length).fill(!1)),setSensitiveDataSelections:()=>{},sensitiveDataQuestionnaireCompleted:!1,setSensitiveDataQuestionnaireCompleted:()=>{},useCaseType:void 0,setUseCaseType:()=>{},templatePipeline:void 0,setTemplatePipeline:()=>{},footerShown:!1,setFooterShown:()=>{},stepNext:void 0,setStepNext:()=>{},disabledNextText:void 0,setDisabledNextText:()=>{},isAttachmentHipaaCovered:!1,hipaaCoverageRefresh:()=>{},populatePriceEstimator:!1,setPopulatePriceEstimator:()=>{},firstTimeTemplate:!1,setFirstTimeTemplate:()=>{},useOnboardingV3:!1,collapseSidebar:!1,setCollapseSidebar:()=>{}});var pe=n(569465),ue=n(376189);function he(e,t,n,i,a,o,s){try{var r=e[o](s),l=r.value}catch(c){return void n(c)}r.done?t(l):Promise.resolve(l).then(i,a)}function me(e){return function(){var t=this,n=arguments;return new Promise((function(i,a){var o=e.apply(t,n);function s(e){he(o,i,a,s,r,"next",e)}function r(e){he(o,i,a,s,r,"throw",e)}s(void 0)}))}}function fe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){fe(e,t,n[t])}))}return e}const ge="What does this example illustrate? Click here to add a description.",ye=(0,o.ZL)({container:{display:"flex",flexDirection:"column",justifyContent:"center",flexFlow:"column nowrap",flexWrap:"nowrap"},dialog:{width:"100%",overflow:"hidden",margin:"2% auto 20px"},dialogRoot:{zIndex:"110 !important"},exampleTypeSelector:{display:"flex",justifyContent:"center",marginBottom:"12px"},exampleType:{margin:"8px",padding:"2px 8px 2px 8px",border:"1px solid #E6E6E6",borderRadius:"8px",cursor:"pointer"},selectorControls:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:"24px"},createButton:{display:"flex",width:"100%",alignItems:"center",justifyContent:"flex-end"}});var be=({modalOpen:e,lastSelection:t,project:n,uploadedAssets:o,taxonomy:s,location:r,caption:p,setModalOpen:h,handleSave:m,trayExamples:x,setTrayExamples:g})=>{const b=ye(),{0:v,1:j}=(0,a.useState)(0),{0:w}=(0,a.useState)({}),{0:T}=(0,a.useState)({}),{0:I,1:O}=(0,a.useState)("good"),{0:N,1:k}=(0,a.useState)(!1),{0:E,1:C}=(0,a.useState)(p),{0:A,1:P}=(0,a.useState)(void 0),{0:_,1:R}=(0,a.useState)(""),{0:D,1:L}=(0,a.useState)(x||r.examples||[]),{0:Z,1:M}=(0,a.useState)(!1),{0:F,1:z}=(0,a.useState)(!1),{0:$,1:W}=(0,a.useState)(-1),{0:Y,1:q}=(0,a.useState)(!1),{fetchUnprocessedAttachments:X}=(0,ue.Z)(),{taskType:K}=(0,a.useContext)(de),ee=(0,u.ui)(),te=function(){var e=me((function*(e){return w[e]||(w[e]=(yield c.Z.selfserve.fetchAssetS3URL({assetId:e})).signedURL),w[e]}));return function(t){return e.apply(this,arguments)}}(),ie=function(){var e=me((function*(){if(se.current){const e=yield se.current.getReviewChanges();return K===U.UAI.Categorization?e.taxonomies&&e.taxonomies.length>0:e.annotations&&e.annotations.length>0}return!1}));return function(){return e.apply(this,arguments)}}(),ae=function(){var e=me((function*(e){return T[e]||(T[e]=(yield c.Z.selfserve.fetchAssetPages({assetId:e})).pageURLs),T[e]}));return function(t){return e.apply(this,arguments)}}(),oe=function(){var e=me((function*(e,t){const{attachment:n}=yield c.Z.selfserve.fetchAssetToTemplateAttachment({assetId:e,project:t.id});return n}));return function(t,n){return e.apply(this,arguments)}}();(0,a.useEffect)((()=>{e&&j(0)}),[e]),(0,a.useEffect)((()=>{let e=!1;function t(){return(t=me((function*(){if(o&&o.length>0){P(void 0);const i=yield(0,J.kh)(null!==K&&void 0!==K?K:n.type,o[v],s,!0,te,ae,n.useTextCollectionTemplate?oe:void 0,n);var t;if(i.attachments&&y().every(i.attachments,(e=>"unprocessed"===e.type)))i.attachments=yield X(null!==(t=i.attachments)&&void 0!==t?t:[]);e||P(xe({},Q.QS,{type:null!==K&&void 0!==K?K:n.type,params:i,assignment:{projectId:n.id,params:i,type:null!==K&&void 0!==K?K:n.type,featureFlags:{showSidebar:(null!==K&&void 0!==K?K:n.type)===U.UAI.NamedEntityRecognition||void 0}},timerDisabled:!0,shouldWarnOnExit:!1,readOnly:!1,editable:!0,canEdit:!0,isCustomer:!0,showHeader:!1,isTaxonomyDisplay:!0,showFooter:!1}))}o&&o[v+1]&&(null!==K&&void 0!==K?K:n.type)===U.UAI.DocumentTranscription&&c.Z.selfserve.fetchAssetPages({assetId:o[v+1]._id})}))).apply(this,arguments)}return function(){t.apply(this,arguments)}(),function(){e=!0}}),[n,o,s,v]);const se=(0,a.useRef)(),re=function(){var e=me((function*(){if(k(!0),se.current&&n){const t=yield se.current.getReviewChanges(),i=o[v]._id,a={project:n.id,type:null!==K&&void 0!==K?K:n.type,uploadedAsset:i,taxonomy:s,response:t};try{const{taskId:e,msg:t}=yield c.Z.selfserve.setInstructionsExample(a);if(!t){const t={taskId:e,isGoodExample:"good"===I};t.caption=E,d.YR.setNodes(ee,{examples:[...D,t]},{at:r.path}),L([...D,t]),le(),g&&g([...D,t])}R("")}catch(e){R("verify that the response is valid")}k(!1)}}));return function(){return e.apply(this,arguments)}}(),le=()=>{M(!0),q(!0),setTimeout((()=>M(!1)),2e3)},ce=e=>{W(e),z(!0)};return(0,i.jsxs)(i.Fragment,{children:[F&&(0,i.jsx)(ne,{isOpen:F,message:"do you want to change images without saving the example?",onSubmit:()=>{j($),W(-1),q(!1),z(!1)},onRequestClose:()=>z(!1)}),(0,i.jsxs)(S.Vq,{classes:{root:b.dialogRoot,paper:b.dialog},maxWidth:"lg",open:e,onClose:e=>{"keydown"===(null===e||void 0===e?void 0:e.type)&&27===(null===e||void 0===e?void 0:e.keyCode)||(!N&&t&&t.anchor&&d.YR.select(ee,t),m&&m(),h(!1))},children:[(0,i.jsx)(S.$N,{children:(0,i.jsx)("div",{style:{textAlign:"center",fontWeight:500,fontSize:"16px",lineHeight:"20px"},children:"Create both well labeled and poorly labeled examples"})}),(0,i.jsxs)(S.cZ,{children:[(!o||0===o.length)&&(0,i.jsx)("h6",{className:"jsx-8b0aa6d31560dfb1",children:"No assets to display..."}),o&&o.length>0&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(V,{exampleType:I,setExampleType:O,disabled:N,readOnly:!1}),_.length>0&&(0,i.jsx)(S.bZ,{severity:"error",style:{marginTop:"2px",marginBottom:"12px"},children:_}),Z&&(0,i.jsx)(S.bZ,{severity:"success",style:{marginTop:"2px",marginBottom:"12px"},children:"example created!"}),A?(0,i.jsx)(pe.Z,{children:(0,i.jsx)(a.Suspense,{fallback:(0,i.jsx)(B.Z,{style:{paddingBottom:"16px"}}),children:(0,i.jsx)("div",{className:"jsx-8b0aa6d31560dfb1 component",children:(0,i.jsx)(H.M5,{children:(0,i.jsx)(G.Z,{taskType:A.type,taskProps:A,taskRef:se,isTaxonomyDisplay:"categorization"!==(null!==K&&void 0!==K?K:n.type)})})})})}):(0,i.jsx)(B.Z,{style:{paddingBottom:"16px"}}),(0,i.jsx)("input",{value:E,placeholder:ge,style:{opacity:.75,marginTop:12,textAlign:"center",border:0,fontSize:"14px",width:"100%"},onFocus:e=>e.target.placeholder="",onBlur:e=>e.target.placeholder=ge,onChange:e=>{e.preventDefault(),C(e.target.value)},className:"jsx-8b0aa6d31560dfb1"}),(0,i.jsxs)("div",{className:"jsx-8b0aa6d31560dfb1 "+(b.selectorControls||""),children:[(0,i.jsx)(S.u,{arrow:!0,placement:"top",title:"jump to first asset",children:(0,i.jsx)("div",{className:"jsx-8b0aa6d31560dfb1",children:(0,i.jsx)("a",{onClick:me((function*(){N||(!Y&&(yield ie())?ce(0):(j(0),q(!1)))})),className:"jsx-8b0aa6d31560dfb1",children:(0,i.jsx)(f.G,{icon:"angle-double-left",color:"black",style:{width:16,height:16,marginLeft:8,marginTop:4}})})})}),(0,i.jsx)(S.u,{arrow:!0,placement:"top",title:"view previous asset",children:(0,i.jsx)("div",{className:"jsx-8b0aa6d31560dfb1",children:(0,i.jsx)("a",{style:{marginLeft:"8px"},onClick:me((function*(){const e=(v-1+o.length)%o.length;N||(!Y&&(yield ie())?ce(e):(j(e),q(!1)))})),className:"jsx-8b0aa6d31560dfb1",children:(0,i.jsx)(f.G,{icon:"angle-left",color:"black",style:{width:16,height:16,marginLeft:8,marginTop:4}})})})}),(0,i.jsxs)("p",{style:{margin:"0px 10px 0px 10px"},className:"jsx-8b0aa6d31560dfb1",children:[v+1," of ",o.length]}),(0,i.jsx)(S.u,{arrow:!0,placement:"top",title:"view next asset",children:(0,i.jsx)("div",{className:"jsx-8b0aa6d31560dfb1",children:(0,i.jsx)("a",{style:{marginRight:"8px"},onClick:me((function*(){const e=(v+1)%o.length;N||(!Y&&(yield ie())?ce(e):(j(e),q(!1)))})),className:"jsx-8b0aa6d31560dfb1",children:(0,i.jsx)(f.G,{icon:"angle-right",color:"black",style:{width:16,height:16,marginLeft:8,marginTop:4}})})})}),(0,i.jsx)(S.u,{arrow:!0,placement:"top",title:"jump to last asset",children:(0,i.jsx)("div",{className:"jsx-8b0aa6d31560dfb1",children:(0,i.jsx)("a",{onClick:me((function*(){const e=o.length-1;N||(!Y&&(yield ie())?ce(e):(j(e),q(!1)))})),className:"jsx-8b0aa6d31560dfb1",children:(0,i.jsx)(f.G,{icon:"angle-double-right",color:"black",style:{width:16,height:16,marginLeft:8,marginTop:4}})})})})]})]}),(0,i.jsx)(l(),{id:"8b0aa6d31560dfb1",children:".component{height:540px}.component,.component .task{-webkit-box-flex:1;-webkit-flex-grow:1;-moz-box-flex:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:0;min-width:0;width:100%;overflow:auto}.task__splitpane{position:relative;overflow:auto}"}),(0,i.jsx)("div",{className:"jsx-8b0aa6d31560dfb1 "+(b.createButton||""),children:(0,i.jsx)(S.zx,{type:"primary",onClick:re,disabled:N,children:N?"Saving":"Save example"})})]})]})]})},ve=n(449863);function je(e,t,n,i,a,o,s){try{var r=e[o](s),l=r.value}catch(c){return void n(c)}r.done?t(l):Promise.resolve(l).then(i,a)}function we(e){return function(){var t=this,n=arguments;return new Promise((function(i,a){var o=e.apply(t,n);function s(e){je(o,i,a,s,r,"next",e)}function r(e){je(o,i,a,s,r,"throw",e)}s(void 0)}))}}function Se(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){Se(e,t,n[t])}))}return e}const Ie=(0,b.ZL)({dialog:{width:"100%",overflow:"hidden",margin:"3% auto 20px"},zIndexHigh:{zIndex:"2000 !important"},zIndexLow:{zIndex:"110 !important"},title:{textAlign:"center"}});var Oe=({modalOpen:e,taskInfo:t,taskId:n,location:o,lastSelection:s,readOnly:r,setModalOpen:p,hasOpenedExample:h,projectTemplateId:m,handleUpdateExample:f})=>{const x=Ie(),{0:g,1:b}=(0,a.useState)(!1),v=(0,a.useRef)(),j=(0,u.ui)(),{0:w,1:T}=(0,a.useState)(""),{0:I,1:O}=(0,a.useState)(""),{0:N,1:k}=(0,a.useState)(void 0),{data:E}=(0,ve.Z)(n,r,m),{goodExample:C,caption:A}=t,{params:P,response:_,type:R,projectId:D,status:L}=E,{0:Z,1:M}=(0,a.useState)(A),{0:F,1:z}=(0,a.useState)(C?"good":"bad"),$=(0,X.useQueryClient)(),{fetchUnprocessedAttachments:W}=(0,ue.Z)(),J=!r&&N&&L===U.hYU.Completed;(0,a.useEffect)((()=>{let e=!1;function t(){return(t=we((function*(){if(!g&&P&&R&&D){k(void 0);const i=P;var t;if(i&&i.attachments&&i.attachments.length>0&&y().every(i.attachments,(e=>"unprocessed"===e.type)))i.attachments=yield W(null!==(t=i.attachments)&&void 0!==t?t:[]);e||(h&&h(n,C),k(Te({},Q.QS,{assignment:{params:i,projectId:D,type:R},type:R,params:i,fixResponse:_,timerDisabled:!0,shouldWarnOnExit:!1,readOnly:!J,editable:J,isCustomer:!0,showHeader:!1,isTaxonomyDisplay:!0,showFooter:!1})))}}))).apply(this,arguments)}return function(){t.apply(this,arguments)}(),function(){e=!0}}),[t]);const K=()=>{T("Task update failed"),setTimeout((()=>T("")),2e3)},ee=function(){var e=we((function*(){if(O(""),T(""),b(!0),o&&o.examples){const e=[...o.examples],t=y().map(e,(e=>{if(e.taskId===n){const t={isGoodExample:"good"===F};return t.caption=Z,Object.assign({},e,t)}return e}));d.YR.setNodes(j,{examples:t},{at:o.path})}if(v.current)try{const e=yield v.current.getReviewChanges(),t=yield c.Z.selfserve.updateInstructionsExample({task:n,response:e});$.invalidateQueries(["use-instruction-task-data",n]),t.success?(k(Te({},N,{fixResponse:e})),O("Task updated"),setTimeout((()=>O("")),2e3)):K()}catch(e){K()}b(!1),f&&f({taskId:n,caption:Z,isGoodExample:"good"===F})}));return function(){return e.apply(this,arguments)}}();return(0,i.jsxs)(S.Vq,{classes:{root:r?x.zIndexHigh:x.zIndexLow,paper:x.dialog},maxWidth:"lg",open:e,onClose:e=>{"keydown"===(null===e||void 0===e?void 0:e.type)&&27===(null===e||void 0===e?void 0:e.keyCode)||(s&&s.anchor&&d.YR.select(j,s),p(!1))},children:[(0,i.jsx)(S.$N,{children:(0,i.jsx)("div",{className:x.title,children:"Example"})}),(0,i.jsxs)(S.cZ,{children:[!N&&(0,i.jsx)("h6",{className:"jsx-78deb52573c15da2",children:"No Images to display..."}),N&&L!==U.hYU.Completed&&(0,i.jsx)(Y.Z,{severity:"info",style:{marginTop:"16px"},children:"Annotations are still being processed"}),w.length>0&&(0,i.jsx)(Y.Z,{severity:"error",style:{marginTop:"2px",marginBottom:"12px"},children:w}),I.length>0&&(0,i.jsx)(Y.Z,{severity:"success",style:{marginTop:"2px",marginBottom:"12px"},children:I}),N&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(V,{exampleType:F,setExampleType:e=>{r||z(e)},disabled:r,readOnly:r}),(0,i.jsx)(pe.Z,{children:(0,i.jsx)(a.Suspense,{fallback:(0,i.jsx)(B.Z,{style:{paddingBottom:"16px"}}),children:(0,i.jsx)("div",{className:"jsx-78deb52573c15da2 component",children:(0,i.jsx)(H.M5,{children:(0,i.jsx)(G.Z,{taskType:N.type,taskProps:N,taskRef:v,isTaxonomyDisplay:!0})})})})})]}),(0,i.jsx)(l(),{id:"78deb52573c15da2",children:".component{height:540px}.component,.component .task{-webkit-box-flex:1;-webkit-flex-grow:1;-moz-box-flex:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:0;min-width:0;width:100%;overflow:auto}.task__splitpane{position:relative;overflow:auto}"}),J&&(0,i.jsx)("input",{value:Z,placeholder:ge,style:{opacity:.75,marginTop:12,textAlign:"center",border:0,fontSize:"14px",width:"100%"},onFocus:e=>e.target.placeholder="",onBlur:e=>e.target.placeholder=ge,onChange:e=>{e.preventDefault(),M(e.target.value)},className:"jsx-78deb52573c15da2"}),A&&!J&&(0,i.jsx)("div",{style:{marginTop:12,textAlign:"center",background:"white",border:0,fontSize:"14px",width:"100%"},className:"jsx-78deb52573c15da2",children:A})]}),J?(0,i.jsx)(S.kX,{children:(0,i.jsx)(q.zx,{onClick:()=>ee(),disabled:g||!J,type:"primary",children:"Update"})}):(0,i.jsx)(i.Fragment,{})]})};function Ne(e,t,n,i,a,o,s){try{var r=e[o](s),l=r.value}catch(c){return void n(c)}r.done?t(l):Promise.resolve(l).then(i,a)}function ke(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){ke(e,t,n[t])}))}return e}const Ce=({taskId:e,isGoodExample:t,location:n,index:o,caption:s,readOnly:r,onDelete:l,hasOpenedExample:c,projectTemplateId:d,onUpdate:p})=>{const h=Ae(),m=(0,u.ui)(),{0:x,1:g}=(0,a.useState)(!1),{0:y,1:b}=(0,a.useState)(null),{isLoading:v,data:j}=(0,ve.Z)(e,r,d);if(v)return(0,i.jsx)("div",{children:"Loading..."});const w=t?"green":"red",{attachmentType:S,attachment:T}=(e=>{if(!e)return{attachmentType:null,attachment:null};let t,n;const i=e.type;return i===U.UAI.TextCollection?(t=e.params.attachments[0].type,n=e.params.attachments[0].content):i===U.UAI.NamedEntityRecognition?(t="text",n=e.params.text):i===U.UAI.DocumentTranscription?(t="image",n=e.params.attachments[0]):(t=e.params.attachment_type,n=e.params.attachment),{attachmentType:t,attachment:n}})(j);return(0,i.jsxs)("div",{className:h.label,children:[x&&(0,i.jsx)(Oe,{modalOpen:x,lastSelection:y,setModalOpen:e=>g(e),taskId:e,location:n,taskInfo:Ee({},j,{goodExample:t,caption:s}),readOnly:r,hasOpenedExample:c,projectTemplateId:d,handleUpdateExample:p}),(0,i.jsx)("div",{children:(0,i.jsxs)("div",{onClick:function(){var e,t=(e=function*(e){e.preventDefault(),b(m.selection),g(!0)},function(){var t=this,n=arguments;return new Promise((function(i,a){var o=e.apply(t,n);function s(e){Ne(o,i,a,s,r,"next",e)}function r(e){Ne(o,i,a,s,r,"throw",e)}s(void 0)}))});return function(e){return t.apply(this,arguments)}}(),children:[(0,i.jsx)("div",{children:(e=>{const t=!r&&(0,i.jsx)(P,{onClick:()=>l()});let n=null;return"pdf"===S?n=(0,i.jsx)(f.G,{icon:["far","file-pdf"]}):"image"===S?n=(0,i.jsx)(f.G,{icon:["far","file-image"]}):"audio"===S?n=(0,i.jsx)(f.G,{icon:["far","file-audio"]}):"website"===S?n=(0,i.jsx)(f.G,{icon:["far","globe"]}):"text"===S?n=(0,i.jsx)(f.G,{icon:["far","file-alt"]}):"video"===S&&(n=(0,i.jsx)(f.G,{icon:["far","video"]})),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",alignItems:"center"},children:[n," ",(0,i.jsxs)("span",{style:{padding:"4px"},children:["Example ",e]})," ",t]})})(o+1)}),(0,i.jsx)("div",{className:h.preview,style:{border:`2px solid ${w}`},children:(I=T,O=S,I&&O?"image"===O||"unprocessed"===O?(0,i.jsx)("img",{className:h.img,src:I,crossOrigin:"anonymous"}):"text"===O?(0,i.jsx)("div",{className:h.text,children:I}):"pdf"===O?(0,i.jsx)("object",{className:h.pdf,data:I}):"audio"===O||"transcription_audio"===O?(0,i.jsx)("audio",{className:h.audio,src:I,controls:!0}):"website"===O?(0,i.jsx)("div",{className:h.website,children:I}):"video"===O?(0,i.jsx)("video",{className:h.video,src:I}):null:(0,i.jsx)("div",{className:h.text,children:"Error loading example."}))})]})})]});var I,O},Ae=(0,o.ZL)({label:{"&:hover $button":{opacity:1},position:"relative"},button:{opacity:"0",top:"-6px",right:"-6px",position:"absolute",zIndex:1,color:"gray"},preview:{width:"120px",height:"120px",position:"relative"},img:{objectFit:"cover",width:"120px",height:"120px"},pdf:{width:"100%",height:"100%",overflow:"hidden",pointerEvents:"none"},audio:{width:"100%",height:"100%",background:"#dddddd"},video:{width:"100%",height:"100%",background:"#dddddd",padding:"2px",boxSizing:"border-box"},website:{background:"#dddddd",fontSize:"10px",overflow:"hidden",width:"100%",height:"100%",boxSizing:"border-box",padding:"4px"},text:{background:"#dddddd",fontSize:"10px",overflow:"hidden",width:"100%",height:"100%",boxSizing:"border-box",padding:"4px"}}),Pe=(0,S.ZL)({loadingIconContainer:{display:"flex",justifyContent:"center",alignItems:"center"},container:{scrollbarWidth:"none",display:"flex",flexWrap:"wrap",flexDirection:"row",gap:b.ZP.spacing(3),borderRadius:"8px",marginTop:"8px",overflowX:"auto",overflowY:"hidden",padding:"4px",msOverflowStyle:"none","&::-webkit-scrollbar":{display:"none"}},example:{border:"1px dashed #CCCCCC",borderRadius:"4px",height:"64px",textAlign:"center",verticalAlign:"middle",lineHeight:"64px"},descriptionText:{opacity:.5},addMoreBtn:{color:b.ZP.colors.periwinkle100}});var _e=({examples:e,element:t,location:n,setLocation:a,readOnly:o,handleDeleteExample:s,setExampleModalOpen:r,setExampleSelectionGridOpen:l,hasOpenedExample:c,projectTemplateId:d,isMigration:p})=>{const h=Pe(),m=(0,u.ui)();return(0,i.jsx)("div",{children:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:h.descriptionText,children:"Green border indicates well annotated example and red border indicates poorly annotated example"}),(0,i.jsx)("div",{className:h.container,children:e.map(((r,l)=>(0,i.jsx)("div",{onClick:()=>{a({examples:e,path:u.F3.findPath(m,t)})},children:(0,i.jsx)(Ce,{taskId:r.taskId,isGoodExample:r.isGoodExample,location:n,onDelete:()=>s(r.taskId),readOnly:o,index:l,caption:r.caption,hasOpenedExample:c,projectTemplateId:d,isMigration:p})},l)))}),0===e.length&&!o&&(0,i.jsx)("div",{className:h.example,children:(0,i.jsx)("a",{onClick:()=>{a({examples:e,path:u.F3.findPath(m,t)}),l?l(!0):r(!0)},children:"+ Add examples"})}),e.length>0&&!o&&(0,i.jsx)("a",{onClick:()=>{a({examples:e,path:u.F3.findPath(m,t)}),l?l(!0):r(!0)},className:h.addMoreBtn,children:"Add more examples"})]})})};function Re(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const De=({attributes:e,children:t,element:n,readOnly:o,location:s,setLocation:r,setExampleModalOpen:l,setExampleSelectionGridOpen:c,hasOpenedExample:p,projectTemplateId:h,isMigration:m})=>{const f=Le(),x=(0,u.ui)(),{labelName:g,examples:y}=n,{0:b,1:v}=(0,a.useState)(y.length<10),{0:j,1:w}=(0,a.useState)(g);return(0,i.jsxs)("div",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){Re(e,t,n[t])}))}return e}({},e,{contentEditable:!1,className:f.labelBlock,children:[(0,i.jsxs)("div",{className:f.labelHeader,children:[(0,i.jsx)("div",{className:f.labelNameContainer,children:(0,i.jsx)("input",{className:f.labelName,value:j,disabled:o,onChange:e=>{e.preventDefault(),w(e.target.value)},onBlur:e=>{e.preventDefault();const t=u.F3.findPath(x,n);d.YR.setNodes(x,{labelName:j},{at:t})}})}),(0,i.jsxs)("button",{className:f.toggleButton,onClick:()=>{r({examples:y,path:u.F3.findPath(x,n)}),v(!b)},children:[b?"Hide":"Show"," examples (",y.length,")"]})]}),y&&b&&(0,i.jsx)(_e,{readOnly:o,examples:y,element:n,location:s,setLocation:r,setExampleModalOpen:l,setExampleSelectionGridOpen:c,handleDeleteExample:e=>{if(o)return;const t=u.F3.findPath(x,n),i=y.filter((t=>t.taskId!==e));d.YR.setNodes(x,{examples:i},{at:t})},hasOpenedExample:p,projectTemplateId:h,isMigration:m}),(0,i.jsx)("div",{children:t})]}))},Le=(0,o.ZL)({labelBlock:{background:"#f2f2f2",borderRadius:8,margin:"16px 12px",padding:16},labelHeader:{display:"flex"},labelNameContainer:{width:"40%",flexShrink:0,fontWeight:500},labelName:{border:0,background:"#f2f2f2",fontWeight:500,fontSize:"16px",width:"100%"},toggleButton:{color:b.ZP.colors.periwinkle100,outline:"none",position:"relative",marginLeft:"auto",border:"none",padding:"0 8px",height:20,flexShrink:0,borderRadius:50,background:"transparent",fontSize:12,fontWeight:500,cursor:"pointer",transition:"background 120ms ease-out","&:hover":{background:"white"},"&:disabled":{opacity:.5}}});function Ze(e,t,n,i,a,o,s){try{var r=e[o](s),l=r.value}catch(c){return void n(c)}r.done?t(l):Promise.resolve(l).then(i,a)}function Me(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){Me(e,t,n[t])}))}return e}const Ue=["numbered-list","bulleted-list"],Be=["label-section","iframe"],ze=e=>{const{isVoid:t}=e;return e.isVoid=e=>!!Be.includes(e.type)||t(e),e},$e=e=>{const{attributes:t,children:n,element:a}=e;switch(a.type){case"block-quote":return(0,i.jsx)("blockquote",Fe({},t,{style:{borderLeft:"2px solid #ddd",marginLeft:0,marginRight:0,paddingLeft:"10px",color:"#666",fontStyle:"italic"},children:n}));case"bulleted-list":return(0,i.jsx)("ul",Fe({},t,{children:n}));case"heading-1":return n&&n.props&&n.props.node&&n.props.node.children.length>0?(0,i.jsx)("section",Fe({id:"#"+n.props.node.children[0].text.split(" ").join("_")+"-h1"},t,{children:(0,i.jsx)("h1",{children:n})})):(0,i.jsx)("h1",Fe({},t,{children:n}));case"heading-2":return(0,i.jsx)("h2",Fe({},t,{children:n}));case"heading-3":return(0,i.jsx)("h3",Fe({},t,{children:n}));case"heading-4":return(0,i.jsx)("h4",Fe({},t,{children:n}));case"list-item":return(0,i.jsx)("li",Fe({},t,{children:n}));case"numbered-list":return(0,i.jsx)("ol",Fe({},t,{children:n}));case"label-section":return(0,i.jsx)(De,Fe({},e,{children:n}));case"image":return(0,i.jsx)(F,Fe({},e,{children:n}));case"iframe":return(0,i.jsx)(R,Fe({},e,{children:n}));default:return(0,i.jsx)("p",Fe({},t,{children:n}))}},We=({attributes:e,children:t,leaf:n})=>(n.bold&&(t=(0,i.jsx)("strong",{children:t})),n.code&&(t=(0,i.jsx)("code",{children:t})),n.italic&&(t=(0,i.jsx)("em",{children:t})),n.underline&&(t=(0,i.jsx)("u",{children:t})),(0,i.jsx)("span",Fe({},e,{children:t}))),Ve=(e,t)=>{Ge(e,t)?d.ML.removeMark(e,t):d.ML.addMark(e,t,!0)},Ge=(e,t)=>{const n=d.ML.marks(e);return!!n&&!0===n[t]},He=(e,t)=>{const[n]=d.ML.nodes(e,{match:e=>!d.ML.isEditor(e)&&d.W_.isElement(e)&&e.type===t});return!!n},Ye=(e,t)=>{const n=He(e,t),i=Ue.includes(t);d.YR.unwrapNodes(e,{match:e=>Ue.includes(!d.ML.isEditor(e)&&d.W_.isElement(e)&&e.type),split:!0});const a={type:n?"paragraph":i?"list-item":t};if(d.YR.setNodes(e,a),!n&&i){const n={type:t,children:[]};d.YR.wrapNodes(e,n)}};var qe=({blocks:e,setBlocks:t,project:n,uploadedAssets:o,taxonomy:r,readOnly:h,hasSensitiveContent:m=!1,handleSave:f,isDirty:x=!1,isEdgeCase:g=!1,setInfoMsg:y,updatedAt:b,hasOpenedExample:v,projectTemplateId:j})=>{var w;const{0:S,1:T}=(0,a.useState)(null),{0:I,1:O}=(0,a.useState)(null),{0:N,1:k}=(0,a.useState)(!1),E=(0,a.useMemo)((()=>ze((0,p.VC)((0,u.BU)((0,d.Jh)())))),[]),C=(0,a.useCallback)((e=>(0,i.jsx)($e,Fe({},e,{setInfoMsg:y,readOnly:h,location:S,setLocation:T,setExampleModalOpen:k,hasOpenedExample:v,projectTemplateId:j}))),[h,S]),P=function(){var e,t=(e=function*(){const{isWorker:e}=yield c.Z.selfserve.adultContentToggle({blockAdultContent:!0});e&&(window.location.href="/")},function(){var t=this,n=arguments;return new Promise((function(i,a){var o=e.apply(t,n);function s(e){Ze(o,i,a,s,r,"next",e)}function r(e){Ze(o,i,a,s,r,"throw",e)}s(void 0)}))});return function(){return t.apply(this,arguments)}}(),_=(0,a.useCallback)((e=>(0,i.jsx)(We,Fe({},e))),[]);return(0,i.jsxs)("div",{className:"jsx-d9c381bd5a1ff838 slate",children:[!!(null===n||void 0===n||null===(w=n.taxonomy)||void 0===w?void 0:w.param_chunks)&&(0,i.jsx)("h1",{style:{color:"blue"},className:"jsx-d9c381bd5a1ff838",children:"This project contains different types of tasks. Please refer to the relevant instruction sections for the questions and annotations you are given."}),g&&(0,i.jsx)("h1",{style:{color:"orange"},className:"jsx-d9c381bd5a1ff838",children:'This is an edge case detection task. The primary goal is to determine whether the following instructions are detailed and specific enough to complete the task WITHOUT AMBIGUITY. Please provide your feedback in the "edge case feedback" modal at the bottom of the task page.'}),m&&(0,i.jsxs)("h1",{style:{color:"red"},className:"jsx-d9c381bd5a1ff838",children:["WARNING: this project may contain sensitive content. If you're not comfortable with this, please ",(0,i.jsx)("a",{onClick:P,className:"jsx-d9c381bd5a1ff838",children:"exit now"})," to work on other projects."]}),!h&&(0,i.jsx)(s.NL,{when:x,message:"Are you sure you want to leave? Your changes have not been saved."}),(0,i.jsxs)(u.mH,{editor:E,value:e,onChange:e=>t(e),children:[N&&(0,i.jsx)(be,{modalOpen:N,setModalOpen:e=>k(e),project:n,uploadedAssets:o,taxonomy:r,location:S,lastSelection:E.selection,handleSave:x?f:void 0}),!h&&(0,i.jsx)(A,{isMarkActive:Ge,isBlockActive:He,toggleMark:Ve,toggleBlock:Ye,lastSelection:I,handleSave:f,shouldShowLabeledExamples:r&&o,updatedAt:b}),(0,i.jsx)("div",{style:{overflowY:"auto",overflowX:"hidden"},className:"jsx-d9c381bd5a1ff838",children:(0,i.jsx)(u.CX,{renderElement:C,renderLeaf:_,placeholder:"Type here...",spellCheck:!0,autoFocus:!0,readOnly:h,onBlur:()=>{O(E.selection)}})})]}),(0,i.jsx)(l(),{id:"d9c381bd5a1ff838",children:".slate section{-webkit-border-top-right-radius:0px!important;-moz-border-radius-topright:0px!important;border-top-right-radius:0px!important;width:100%;height:100%;-webkit-border-bottom-right-radius:0px!important;-moz-border-radius-bottomright:0px!important;border-bottom-right-radius:0px!important;border:0px!important;border-left:0;border-top:0;margin-top:0px!important}.slate{color:black}"})]})},Qe=n(439804),Xe=n.n(Qe),Je=(n(398821),n(463167)),Ke=n.n(Je);n(262290),n(70530);function et(e,t,n,i,a,o,s){try{var r=e[o](s),l=r.value}catch(c){return void n(c)}r.done?t(l):Promise.resolve(l).then(i,a)}!function(){var e,t=(e=function*({csv:e,csvFileString:t,skipValidation:n=!1}){const i=[],a=[];return yield new Promise((o=>{const s={header:!0,skipEmptyLines:!0,step:({data:e,meta:t})=>{var o;if(i.push(e),t.fields||a.push("CSV file missing headers"),e.length>7e4&&a.push("Upload failed. CSV can only contain a maximum of 70000 rows"),!n&&(t.fields&&(t.fields.includes("attachment_url")||t.fields.includes("text")||t.fields.includes("attachments_json"))||a.push('Please ensure the CSV file includes at least one of the columns "attachment_url", "text".'),null===(o=t.fields)||void 0===o?void 0:o.includes("metadata")))for(const n in e){const t=e[n];if(t.metadata)try{JSON.parse(t.metadata)}catch(s){a.push(`Failed to parse metadata for row ${n+1}: ${t.metadata}`)}}},complete:e=>o()};if(e)Ke().parse(e,s);else{if(!t)throw new Error("Must provide csv file");Ke().parse(t,s)}})),{result:i,errors:a}},function(){var t=this,n=arguments;return new Promise((function(i,a){var o=e.apply(t,n);function s(e){et(o,i,a,s,r,"next",e)}function r(e){et(o,i,a,s,r,"throw",e)}s(void 0)}))})}();const tt=(e,t,n,i,a,o)=>{const s=[{type:"heading-1",children:[{text:"Instructions for "+t}]},{type:"heading-2",children:[{text:"Description"}]},{type:"paragraph",children:[{text:i||"[TODO] Describe the purpose of the tasks in 1-2 sentences. High-level purpose should be simple and easy to understand - for example, what type of scenery will they see? How many frames will the labeler see in each task? What types of objects will they need to look for? What is unusual about this task?"}]}];if(n===U.UAI.TextCollection)for(const r of Xe().get(e,"fields",[]))["category","text","field_set","form","select","datetime","number","boolean"].includes(Xe().get(r,"type",""))&&(s.push({type:"heading-3",children:[{text:Xe().startCase(Xe().toLower(r.title))}]}),s.push({type:"paragraph",children:[{text:`[TODO] Describe a "${Xe().startCase(Xe().toLower(r.title))}"...`}]}),s.push({type:"label-section",labelName:Xe().startCase(Xe().toLower(r.title)),examples:[],children:[{text:""}]}));if([U.UAI.ImageAnnotation,U.UAI.VideoPlaybackAnnotation].includes(n))for(const r in Xe().get(e,"geometries",{})){const t=e.geometries[r];s.push({type:"heading-2",children:[{text:Xe().startCase(Xe().toLower(r))+" labels:"}]}),Xe().get(t,"objects_to_annotate",null)&&t.objects_to_annotate.forEach((t=>{let n;n="string"===typeof t?t:Xe().get(t,"choice",null),n&&(s.push({type:"heading-3",children:[{text:Xe().startCase(Xe().toLower(n))}]}),s.push({type:"paragraph",children:[{text:Xe().get(e,`label_descriptions.${r}.${n}.description`,`[TODO] Describe "${Xe().startCase(Xe().toLower(n))}"...`)}]}),s.push({type:"label-section",labelName:Xe().startCase(Xe().toLower(n)),examples:Xe().get(e,`label_descriptions.${r}.${n}.examples`,[]),children:[{text:""}]}))}))}if(n===U.UAI.DocumentTranscription){for(const t in Xe().get(e,"features",{})){const{label:n}=e.features[t];s.push({type:"heading-3",children:[{text:Xe().startCase(Xe().toLower(n))}]}),s.push({type:"paragraph",children:[{text:`[TODO] Describe "${Xe().startCase(Xe().toLower(n))}"...`}]}),s.push({type:"label-section",labelName:Xe().startCase(Xe().toLower(n)),examples:[],children:[{text:""}]})}for(const t in Xe().get(e,"fields",{})){const{field_id:n,title:i}=e.fields[t];s.push({type:"heading-3",children:[{text:Xe().startCase(Xe().toLower(n))}]}),s.push({type:"paragraph",children:[{text:`[TODO] Describe "${Xe().startCase(Xe().toLower(n))}"...`}]}),s.push({type:"label-section",labelName:i,examples:[],children:[{text:""}]})}}if(n===U.UAI.SegmentAnnotation)for(const r of Xe().get(e,"labels",[])){let t;t="string"===typeof r?r:Xe().get(r,"choice",null),t&&(s.push({type:"heading-3",children:[{text:Xe().startCase(Xe().toLower(t))}]}),s.push({type:"paragraph",children:[{text:Xe().get(e,`label_descriptions.${t}.description`,`[TODO] Describe "${Xe().startCase(Xe().toLower(t))}"...`)}]}),s.push({type:"label-section",labelName:t,examples:Xe().get(e,`label_descriptions.${t}.examples`,[]),children:[{text:""}]}))}if(n===U.UAI.NamedEntityRecognition){const t=[...Xe().get(e,"labels",[])];let n=[];for(n=n.concat(Xe().reverse(t));n.length>0;){const t=n[n.length-1];if("object"===typeof t){const{name:n,display_name:i,description:a}=t,o=i||n;o&&(s.push({type:"heading-3",children:[{text:Xe().startCase(Xe().toLower(o))}]}),s.push({type:"paragraph",children:[{text:a||`[TODO] Describe "${Xe().startCase(Xe().toLower(o))}...`}]}),s.push({type:"label-section",labelName:Xe().startCase(Xe().toLower(o)),examples:Xe().get(e,`label_descriptions.${n}.examples`,[]),children:[{text:""}]}))}if(n.pop(),Xe().get(t,"children",null)){const e=[...Xe().get(t,"children",[])];n=n.concat(Xe().reverse(e))}}}(n===U.UAI.ImageAnnotation||n===U.UAI.SegmentAnnotation)&&e&&e.annotation_attributes&&Object.keys(e.annotation_attributes).length>0&&s.push({type:"heading-2",children:[{text:"Annotation Attributes"}]});for(const r in Xe().get(e,"annotation_attributes",{}))s.push({type:"heading-3",children:[{text:Xe().startCase(Xe().toLower(r))}]}),s.push({type:"paragraph",children:[{text:Xe().get(e,`annotation_attributes.${r}.description`,`[TODO] Describe how to label for ${Xe().startCase(Xe().toLower(r))} and add images where appropriate`)}]});n===U.UAI.VideoPlaybackAnnotation&&e.events_to_annotate&&e.events_to_annotate.length>0&&s.push({type:"heading-2",children:[{text:"Events to Annotate"}]});for(const r of Xe().get(e,"events_to_annotate",[]))s.push({type:"heading-3",children:[{text:Xe().startCase(Xe().toLower(r))}]}),s.push({type:"paragraph",children:[{text:Xe().get(e,`label_descriptions.event.${r}.description`,`[TODO] Describe "${Xe().startCase(Xe().toLower(r))}"...`)}]}),s.push({type:"label-section",labelName:Xe().startCase(Xe().toLower(r)),examples:Xe().get(e,`label_descriptions.event.${r}.examples`,[]),children:[{text:""}]});return o===U.Iec.RELEVANCE&&(s.push({type:"heading-3",children:[{text:"Exact"}]}),s.push({type:"paragraph",children:[{text:"The product fully satisfies the query."}]}),s.push({type:"heading-3",children:[{text:"Substitute"}]}),s.push({type:"paragraph",children:[{text:"The product differs from the one intended, but it is functionally equivalent."}]}),s.push({type:"heading-3",children:[{text:"Complement"}]}),s.push({type:"paragraph",children:[{text:"This product is not the one intended, but it could be useful to the customer if they did buy the intended product."}]}),s.push({type:"heading-3",children:[{text:"Irrelevant"}]}),s.push({type:"paragraph",children:[{text:"This product does not satisfy a reasonable understanding of the customer\u2019s intent."}]}),s.push({type:"heading-3",children:[{text:"Unjudgeable"}]}),s.push({type:"paragraph",children:[{text:"This is only to be used if the product cannot be judged, either because the query cannot be understood, or because the product is lacking enough information to determine if it matches the query."}]}),s.push({type:"heading-2",children:[{text:"Flow Chart / Decision Tree"}]}),s.push({type:"paragraph",children:[{text:"[TODO] Insert a decision tree / flow chart to help taskers make the decision"}]})),o===U.Iec.MOS_RANKING&&s.push({type:"paragraph",children:[{text:'Listen to each audio sample carefully and evaluate it on a 5 point scale from "Excellent (5)" to "Bad (1)".'}]}),o===U.Iec.AUDIO_TRANSCRIPTION&&(s.push({type:"paragraph",children:[{text:"Transcribe the audio based on what you hear."}]}),s.push({type:"paragraph",children:[{text:"[TODO] Add more details around how to transcribe the audio."}]})),o===U.Iec.GENERAL_CLASS&&s.push({type:"paragraph",children:[{text:"[TODO] Explain each label choice"}]}),(null===a||void 0===a?void 0:a.length)&&(s.push({type:"heading-2",children:[{text:"Additional Information"}]}),s.push({type:"paragraph",children:[{text:a}]})),s.push({type:"paragraph",children:[{text:" "}]}),s};var nt=n(608139),it=n.n(nt),at=n(942662),ot=n(906781);function st(e,t,n,i,a,o,s){try{var r=e[o](s),l=r.value}catch(c){return void n(c)}r.done?t(l):Promise.resolve(l).then(i,a)}function rt(e){return function(){var t=this,n=arguments;return new Promise((function(i,a){var o=e.apply(t,n);function s(e){st(o,i,a,s,r,"next",e)}function r(e){st(o,i,a,s,r,"throw",e)}s(void 0)}))}}function lt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ct=new X.QueryClient({defaultOptions:{queries:{refetchOnWindowFocus:!1}}}),dt=(0,o.ZL)({buttons:{marginTop:"10px",flexShrink:0,padding:5,display:"flex",gap:10},outerContainer:{height:"85vh",display:"flex",flexDirection:"column",alignItems:"center",overflow:"hidden"},documentContainer:{overflow:"auto",marginLeft:24},documentWrapper:{maxWidth:"68%",height:"75vh",borderRadius:12,marginTop:24,border:"1px solid #E6E6E6",textAlign:"left",paddingTop:32,paddingLeft:32,paddingRight:32,overflow:"auto",background:"white"},instructionWrapper:{width:"1000px !important",overflow:"auto",padding:32,background:"white"},banner:{textAlign:"center",width:"100%",height:"50px",background:"green",color:"white",fontSize:"16px",padding:"15px",fontWeight:600}});var pt=({user:e,project:t,instructionObjectId:n,onSave:o,isEdgeCase:r,isPreviewImg:l=!1,startTasks:d,startButtonText:p,isReviewMode:u})=>{const h=!!n||!t,m=dt(),{0:x,1:g}=(0,a.useState)([{type:"heading-2",children:[{text:"Loading..."}]}]),{0:v,1:j}=(0,a.useState)(void 0),{0:w,1:S}=(0,a.useState)(!0),{0:T,1:I}=(0,a.useState)(!1),{0:O,1:N}=(0,a.useState)(null),{0:k,1:E}=(0,a.useState)(""),{0:C,1:A}=(0,a.useState)(""),{0:P,1:_}=(0,a.useState)(!1),{0:R,1:D}=(0,a.useState)(!1),{0:L,1:Z}=(0,a.useState)(null),{0:M,1:F}=(0,a.useState)(void 0),{0:B,1:z}=(0,a.useState)(void 0),$=(0,a.useRef)(null),W=d&&!!p,V=(null===e||void 0===e?void 0:e.spoofed)||(null===e||void 0===e?void 0:e.email)&&(null===e||void 0===e?void 0:e.email.endsWith("scale.com")),{0:G,1:H}=(0,a.useState)(!1),{0:q,1:Q}=(0,a.useState)(!1),{0:K,1:ee}=(0,a.useState)(!1),te=(0,le.ZP)("use-rapid-instruction-limits",{},!1),{0:ne,1:ie}=(0,a.useState)(0),{0:ae,1:oe}=(0,a.useState)(0),{0:se,1:re}=(0,a.useState)(0),{0:de,1:pe}=(0,a.useState)([]),{0:ue,1:he}=(0,a.useState)([]),{0:me,1:fe}=(0,a.useState)(0),xe=(0,a.useMemo)((()=>!te||G&&q&&K),[te,G,q,K]),{0:ge,1:ye}=(0,a.useState)(null),be=(0,s.k6)();(0,a.useEffect)((()=>{ie((new Date).getTime())}),[ie]),(0,a.useEffect)((()=>{if(!q&&W){let e=20;const t=setInterval((function(){0===e&&(clearInterval(t),Q(!0)),e-=1}),1e3);return()=>{clearInterval(t)}}}),[W,q,n]),(0,a.useEffect)((()=>{function e(){return(e=rt((function*(){let e;if(S(!0),n){try{if(e=yield c.Z.selfserve.fetchProjectInstructions({instructionObjectId:n,showChangeDescriptions:W}),e.instructions){if(W){const e=yield c.Z.selfserve.fetchUserHasSeenInstructions({instructionObjectId:n});e&&(Q(e),H(!0),ee(!0))}const t=u&&e.reviewInstructions?e.reviewInstructions:e.instructions;g(t),j(t),D(e.hasSensitiveContent),je();let i=0,a=0;e.instructions.map((e=>y().has(e,"examples")&&e.examples.map((e=>e.isGoodExample?i++:a++)))),oe(i),re(a),i+a===0&&ee(!0),S(!1),e.updatedAt&&F(e.updatedAt)}else g([{type:"heading-2",children:[{text:`ERROR: no instructions exist for ID ${n}`}]}]),S(!1)}catch(s){E("failed to find the instructions"),S(!1)}return void fe(me+1)}if(!t)return void alert("ERROR: component must be provided ID of either a Project or InstructionObject");try{e=yield c.Z.selfserve.fetchProjectInstructions({project:t.id})}catch(s){E("failed to find the instructions"),S(!1)}const{taxonomy:i}=yield c.Z.selfserve.fetchProjectTaxonomy({project:t.id});ye(i),e.instructions?(g(e.instructions),j(e.instructions),D(e.hasSensitiveContent),e.updatedAt&&F(e.updatedAt)):g(tt(i,t.name,t.type)),S(!1);const a=(yield c.Z.selfserve.fetchProjectAssets({project:t.id})).uploadedAssets,o=a.filter((e=>!!e.usedForLabeledExample));N(o.length>0?o:a),a.length>0&&t.type===U.UAI.DocumentTranscription&&c.Z.selfserve.fetchAssetPages({assetId:a[0]._id}),fe(me+1)}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t,n]),(0,a.useEffect)((()=>{function e(){return(e=rt((function*(){if(t){const{feedback:e,score:n,instructionFeedbackSummary:i}=yield c.Z.selfserve.fetchInstructionPageFeedback({project:t.id});e.length>0&&Z({feedback:e,score:n}),i&&i.length>0&&z(i)}}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t]);const ve=function(){var e=rt((function*(e,n=!1,i){I(!0);try{const a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){lt(e,t,n[t])}))}return e}({project:t.id,instructions:x,updateTasks:e,updateLabelers:n},i&&{changeDescription:i});yield c.Z.selfserve.setProjectInstructions(a),j(x),F(void 0),o&&o(),(0,ce.bd)(t)&&(yield c.Z.studio.trackEvent({event:"Studio Instructions Saved"})),_(!0),setTimeout((()=>_(!1)),5e3)}catch(a){E("failed to save")}I(!1)}));return function(t){return e.apply(this,arguments)}}(),je=y().debounce((()=>{if(G)return;const e=$.current;if(!e||e.scrollHeight<1e3)H(!0);else if(W&&!xe){e.scrollHeight-e.scrollTop-500<=e.clientHeight&&H(!0)}}),10),we=!y().isEqual(x,v),Se=B||(null===L||void 0===L?void 0:L.feedback)||[];return(0,i.jsx)(X.QueryClientProvider,{client:ct,children:(0,i.jsxs)("div",{className:m.outerContainer,children:[W&&(0,i.jsx)("div",{className:m.banner,children:"Read all instructions and view examples to continue!"}),(0,i.jsx)("div",{className:m.documentContainer,ref:$,onScroll:je,children:(0,i.jsxs)("div",{style:{display:l?"block":"flex"},children:[(0,i.jsxs)("div",{className:h?m.instructionWrapper:m.documentWrapper,children:[C&&(0,i.jsx)(Y.Z,{severity:"warning",style:{marginTop:"6px",marginBottom:"6px"},children:C}),k.length>0&&(0,i.jsx)(Y.Z,{severity:"error",style:{marginTop:"6px",marginBottom:"6px"},children:k}),P&&(0,i.jsxs)(Y.Z,{severity:"success",style:{marginTop:"6px",marginBottom:"6px"},children:["Successfully saved! If applicable, please"," ",(0,i.jsx)("a",{onClick:()=>{be.push(`/${(0,J.MT)(be.location.pathname)}/quality?`+it().stringify({project:t.id,spoof:(null===e||void 0===e?void 0:e.spoofed)?e._id:void 0}))},children:"update your quality tasks"}),"!"]}),(0,i.jsx)(qe,{readOnly:h,blocks:x,setBlocks:g,project:t,taxonomy:ge,uploadedAssets:O,hasSensitiveContent:R,isDirty:we,handleSave:T||!we&&!(0,ce.bd)(t)||w?void 0:ve,isEdgeCase:r,setInfoMsg:A,updatedAt:M,hasOpenedExample:(e,t)=>{if(W){const n=t?de:ue;(t?pe:he)([...n,e]);const i=n.length+1>=Math.min(3,t?ae:se),a=(t?ue:de).length>=Math.min(3,t?se:ae);i&&a&&ee(!0)}}},me)]}),!h&&(0,i.jsx)("div",{style:{background:"white",borderRadius:12,width:"21%",marginLeft:12,paddingTop:32,paddingLeft:32,paddingRight:32,marginTop:24},children:L&&L.feedback?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{style:{color:b.ZP.colors.periwinkle100},children:"Feedback from recent calibration batch"}),L.score>-1&&(0,i.jsxs)("div",{style:{marginTop:12},children:[(0,i.jsx)("div",{style:{fontWeight:"bold",marginBottom:8},children:"Overall Calibration Score:"}),Array.from(Array(Math.round(5*L.score/100))).map((e=>(0,i.jsx)(f.G,{icon:"star",color:"gold"},e))),Array.from(Array(5-Math.round(5*L.score/100))).map((e=>(0,i.jsx)(f.G,{icon:"star",color:"gray"},e))),(0,i.jsxs)("span",{style:{marginLeft:12,fontWeight:"bold"},children:[Math.round(L.score),"%"]})]}),(0,i.jsx)("div",{style:{marginTop:16,fontWeight:"bold"},children:"Feedback:"}),(0,i.jsx)("div",{style:{height:"60vh",overflowY:"scroll"},children:Se.map((e=>(0,i.jsx)("li",{style:{marginLeft:16,paddingBottom:4,lineHeight:1.5},children:e},e)))})]}):(0,i.jsxs)("p",{style:{opacity:.75},children:[(0,i.jsx)("strong",{children:"Write guidelines for completing your tasks."})," ",(0,i.jsx)("br",{}),"To host the instructions for collaborative editing, you can use this\xa0",(0,i.jsx)("a",{href:"https://docs.google.com/document/d/1fjgRSni7PNzMCSKw7NqVfGAp29phcf3NzrAojUhpVUY/edit",target:"_blank",rel:"noopener noreferrer",children:"template"})," ","and then embed it as an iframe."]})})]})}),W&&(0,i.jsxs)("div",{className:m.buttons,children:[(0,i.jsx)(at.Z,{disabled:!xe,size:"lg",primary:!0,arrows:!0,onClick:()=>{function e(){return(e=rt((function*(){if(n){const e=Math.round(((new Date).getTime()-ne)/1e3);yield c.Z.selfserve.setUserHasSeenInstructions({instructionObjectId:n,timeSpentSecs:e,usingInstructionRestrictions:te});const t={isNewInstruction:!1,isOnboardingFlow:!1,isDuringTasking:!1,openTabButtonClicked:!1,startTime:ne,closeTime:(new Date).getTime()};yield(0,ot.Kz)(ot.ju.InstructionRenderRecord,t)}}))).apply(this,arguments)}d&&(d(),function(){e.apply(this,arguments)}())},children:xe?p:q?G?de.length<Math.min(ae,3)?"View more well-labeled examples":"View more poorly labeled examples":"Read the entire page":"Take more time to read the instructions"}),V&&(0,i.jsx)(at.Z,{size:"lg",arrows:!0,onClick:d,children:"Force Start (corp user)"})]})]})})}},648019:function(e,t,n){n.d(t,{zT:function(){return m},kh:function(){return x},MT:function(){return g},ir:function(){return v}});n(827378);var i=n(298784),a=n.n(i),o=n(572084),s=n(569423),r=n(1680),l=(n(398821),n(468891)),c=n(335331);n(142262),n(682097);function d(e,t,n,i,a,o,s){try{var r=e[o](s),l=r.value}catch(c){return void n(c)}r.done?t(l):Promise.resolve(l).then(i,a)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(i,a){var o=e.apply(t,n);function s(e){d(o,i,a,s,r,"next",e)}function r(e){d(o,i,a,s,r,"throw",e)}s(void 0)}))}}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){u(e,t,n[t])}))}return e}const m="MMM DD, YYYY",f=e=>{const t=(e=>"string"===typeof e.metadata?JSON.parse(e.metadata):"object"===typeof e.metadata?e.metadata:null)(e);return(null===t||void 0===t?void 0:t.attachment_type)?t.attachment_type:e.mimeType.match("image/*")?o.D6I.Image:e.mimeType.match("audio/*")?o.D6I.Audio:"text/json"===e.mimeType?o.D6I.Json:e.mimeType.match("text/*")&&void 0===e.text?o.D6I.DownloadableText:e.mimeType.match("text/*")?o.D6I.Text:e.mimeType.match("video/*")?o.D6I.Video:"application/pdf"===e.mimeType?o.D6I.Pdf:"unprocessed"===e.mimeType?"unprocessed":null},x=function(){var e=p((function*(e,t,n,i,r,l,c,d,u){const m=f(t),x=t.storageUrl;var g;const y=i?null!==(g=t.signedUrl)&&void 0!==g?g:yield r(t._id,u):x,b={};if(e===o.UAI.DocumentTranscription)"pdf"===m?(b.attachments=yield l(t._id,u),b.attachment_type="image"):b.attachments=[y];else if(e===o.UAI.TextCollection){const e=m===s.EF.Audio?s.EF.TranscriptionAudio:m;if(c)b.attachments=yield c(t._id,d);else if("text/json"===t.mimeType){const e=JSON.parse(t.text||"[]");b.attachments=yield Promise.all(e.map(function(){var e=p((function*(e){return e.assetId?{type:e.type,content:yield r(e.assetId,u)}:e}));return function(t){return e.apply(this,arguments)}}())),b.force_stacked=(j=b.attachments,!a().some(j,(e=>"text"!==e.type)))}else b.attachments=[{type:e,content:"text"===m||"website"===m?t.text:y}]}else if(e===o.UAI.NamedEntityRecognition)if(m===s.EF.DownloadableText){const e=yield fetch(y);b.text=yield e.text()}else b.text=t.text;else if(e===o.UAI.VideoPlaybackAnnotation){var v;b.attachment_type=m,b.attachment=i?y:yield r(t._id,u),b.metadata=t.metadata,b.frame_rate=null!==(v=n.frame_rate)&&void 0!==v?v:1}else b.attachment="text"===m||"website"===m?t.text:y,b.attachment_type=m;var j;return a().pickBy(h({},n,b))}));return function(t,n,i,a,o,s,r,l,c){return e.apply(this,arguments)}}(),g=(o.Iec.WITHOUT_TEMPLATE,o.Iec.AV_IMAGE,o.Iec.AC_IMAGE,o.Iec.LOGI_IMAGE,o.Iec.AV_VIDEO,o.Iec.ARVR_VIDEO,o.Iec.RESUME_DOCUMENTS,o.Iec.INVOICE_DOCUMENTS,o.Iec.TEXT_GEN,o.Iec.RELEVANCE,o.Iec.MOS_RANKING,o.Iec.AUDIO_TRANSCRIPTION,o.Iec.GENERAL_CLASS,o.Iec.NER,e=>{const[,t]=e.match(/\/([^/]*).*$/);return t});function y(e){return e.startsWith(`/${r.Fs.Studio}`)?r.Fs.Studio:e.startsWith(`/${r.Fs.Pro}`)?r.Fs.Pro:r.Fs.Rapid}Object.freeze({regular_batch_launched:{progress:100},launch_regular_batch:{progress:90,text:"Launch production batch",to:"/batches"},quality_tasks:{progress:70,text:"Audit & create quality tasks",to:"/batches"},calibration_review:{progress:55,text:"Review feedback from calibration",to:"/batches"},calibration_create:{progress:45,text:"Create calibration batch",to:"/batches"},instruction_write:{progress:30,text:"Write instructions",to:"/definition"},taxonomy_define:{progress:15,text:"Define taxonomy",to:"/definition"},data_upload:{progress:0,text:"Upload data",to:"/definition"}}),Object.freeze({regular_batch_launched:{progress:100},launch_regular_batch:{progress:70,text:"Launch production batch",to:"/batches"},quality_tasks:{progress:50,text:"Audit & create quality tasks",to:"/batches"},calibration_review:{progress:10,text:"Review feedback from calibration",to:"/batches"},calibration_create:{progress:0,text:"Create calibration batch",to:"/batches"}});var b;!function(e){e.local="Local",e.previous_project="Previous Project",e.s3="Amazon S3",e.gcp="Google Cloud Platform",e.azure="Microsoft Azure",e.url="URL"}(b||(b={}));b.local,b.previous_project,b.s3,b.gcp,b.azure,b.url;const v=()=>{const e=(0,c.k6)();function t(){return y(e.location.pathname)}return{redirect:function(t,n){const{project:i,spoof:a}=l.parse(e.location.search),o=l.stringify(h({project:(null===n||void 0===n?void 0:n.clearProject)?void 0:(null===n||void 0===n?void 0:n.projectId)||i,spoof:a},null===n||void 0===n?void 0:n.additionalArgs));let s;t.startsWith(`/${r.Fs.Rapid}/`)?(s=r.Fs.Rapid,t=t.replace(`/${s}`,"")):t.startsWith(`/${r.Fs.Studio}/`)?(s=r.Fs.Studio,t=t.replace(`/${s}`,"")):t.startsWith(`/${r.Fs.Pro}/`)?(s=r.Fs.Pro,t=t.replace(`/${s}`,"")):s=g(e.location.pathname),e.push({pathname:`/${s}${t}`,search:o})},isRapidUrl:function(){return t()===r.Fs.Rapid},isStudioUrl:function(){return e.location.pathname.includes("studio")},getDashboardPageTypeFromUrlPath:t,convertPathBetweenRapidStudio:function(t){e.replace({pathname:t?e.location.pathname.replace("/studio","/rapid"):e.location.pathname.replace("/rapid","/studio"),search:e.location.search})},urlWithQuerystring:function(t,n){const{spoof:i}=l.parse(e.location.search);if(void 0!==n){const a=n?l.stringify({project:n,spoof:i}):l.stringify({spoof:i});return`/${g(e.location.pathname)}/${t}?${a}`}return`/${g(e.location.pathname)}/${t}${e.location.search}`}}}},142262:function(e,t,n){n.d(t,{Tv:function(){return a},sW:function(){return o},bd:function(){return s}});var i=n(572084);function a(e){return o(e)||s(e)}function o(e){return!!e&&"string"!==typeof e&&e.projectType===i.cdz.SelfServe}function s(e){return!!e&&"string"!==typeof e&&e.projectType===i.cdz.Studio}}}]);